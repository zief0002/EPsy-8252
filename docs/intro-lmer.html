<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Unit 8: Introduction to Mixed-Effects Models | EPsy 8252 Notes</title>
  <meta name="description" content="These are the notes for EPsy 8252.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Unit 8: Introduction to Mixed-Effects Models | EPsy 8252 Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the notes for EPsy 8252." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Unit 8: Introduction to Mixed-Effects Models | EPsy 8252 Notes" />
  
  <meta name="twitter:description" content="These are the notes for EPsy 8252." />
  

<meta name="author" content="Andrew Zieffler">


<meta name="date" content="2019-01-16">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="moreinfocrit.html">
<link rel="next" href="data-codebook.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPsy 8252 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-content"><i class="fa fa-check"></i>Course Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books-and-other-reading-materials"><i class="fa fa-check"></i>Books and Other Reading Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>1</b> R Markdown</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#preparation"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notes"><i class="fa fa-check"></i>Notes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pretty-printing-tables-in-markdown.html"><a href="pretty-printing-tables-in-markdown.html"><i class="fa fa-check"></i>Pretty-Printing Tables in Markdown</a><ul>
<li class="chapter" data-level="1.1" data-path="pretty-printing-tables-in-markdown.html"><a href="pretty-printing-tables-in-markdown.html#summary-statistics-table"><i class="fa fa-check"></i><b>1.1</b> Summary Statistics Table</a></li>
<li class="chapter" data-level="1.2" data-path="pretty-printing-tables-in-markdown.html"><a href="pretty-printing-tables-in-markdown.html#correlation-table"><i class="fa fa-check"></i><b>1.2</b> Correlation Table</a></li>
<li class="chapter" data-level="1.3" data-path="pretty-printing-tables-in-markdown.html"><a href="pretty-printing-tables-in-markdown.html#regression-table"><i class="fa fa-check"></i><b>1.3</b> Regression Table</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html"><i class="fa fa-check"></i><b>2</b> Nonlinearity: Log-Transforming the Predictor</a><ul>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#preparation-1"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="2.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#dataset-and-research-question"><i class="fa fa-check"></i><b>2.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="2.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#log-transformation-of-a-variable"><i class="fa fa-check"></i><b>2.2</b> Log-Transformation of a Variable</a><ul>
<li class="chapter" data-level="2.2.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#quick-refresher-on-logarithms"><i class="fa fa-check"></i><b>2.2.1</b> Quick Refresher on Logarithms</a></li>
<li class="chapter" data-level="2.2.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#log-transforming-variables"><i class="fa fa-check"></i><b>2.2.2</b> Log-Transforming Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>2.3</b> Fitting the Regression Model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#examine-the-assumption-of-linearity"><i class="fa fa-check"></i><b>2.3.1</b> Examine the Assumption of Linearity</a></li>
<li class="chapter" data-level="2.3.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#interpret-the-regression-results"><i class="fa fa-check"></i><b>2.3.2</b> Interpret the Regression Results</a></li>
<li class="chapter" data-level="2.3.3" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#better-interpretations-back-transforming"><i class="fa fa-check"></i><b>2.3.3</b> Better Interpretations: Back-transforming</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#alternative-method-of-fitting-the-model"><i class="fa fa-check"></i><b>2.4</b> Alternative Method of Fitting the Model</a></li>
<li class="chapter" data-level="2.5" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>2.5</b> Plotting the Fitted Model</a></li>
<li class="chapter" data-level="2.6" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#different-base-values-in-the-logarithm"><i class="fa fa-check"></i><b>2.6</b> Different Base Values in the Logarithm</a><ul>
<li class="chapter" data-level="2.6.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#comparing-the-output-from-the-two-bases"><i class="fa fa-check"></i><b>2.6.1</b> Comparing the Output from the Two Bases</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#base-e-logarithm-the-natural-logarithm"><i class="fa fa-check"></i><b>2.7</b> Base-<span class="math inline">\(e\)</span> Logarithm: The Natural Logarithm</a><ul>
<li class="chapter" data-level="2.7.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#using-the-natural-logarithm-in-a-regression-model"><i class="fa fa-check"></i><b>2.7.1</b> Using the Natural Logarithm in a Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#including-covariates"><i class="fa fa-check"></i><b>2.8</b> Including Covariates</a><ul>
<li class="chapter" data-level="2.8.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#plot-of-the-model-results"><i class="fa fa-check"></i><b>2.8.1</b> Plot of the Model Results</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#polynomial-effects-vs.-log-transformations"><i class="fa fa-check"></i><b>2.9</b> Polynomial Effects vs. Log-Transformations</a></li>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#other-resources-1"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html"><i class="fa fa-check"></i><b>3</b> Nonlinearity: Log-Transforming the Outcome</a><ul>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#preparation-2"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="3.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#dataset-and-research-question-1"><i class="fa fa-check"></i><b>3.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="3.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#examine-relationship-between-age-and-budget"><i class="fa fa-check"></i><b>3.2</b> Examine Relationship between Age and Budget</a></li>
<li class="chapter" data-level="3.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#transform-the-outcome-using-the-natural-logarithm-base-e"><i class="fa fa-check"></i><b>3.3</b> Transform the Outcome Using the Natural Logarithm (Base-e)</a></li>
<li class="chapter" data-level="3.4" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#re-analyze-using-the-log-transformed-budget"><i class="fa fa-check"></i><b>3.4</b> Re-analyze using the Log-Transformed Budget</a></li>
<li class="chapter" data-level="3.5" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#interpreting-the-regression-output"><i class="fa fa-check"></i><b>3.5</b> Interpreting the Regression Output</a><ul>
<li class="chapter" data-level="3.5.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#back-transforming-a-more-useful-interpretation"><i class="fa fa-check"></i><b>3.5.1</b> Back-Transforming: A More Useful Interpretation</a></li>
<li class="chapter" data-level="3.5.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#substituting-in-values-for-age-to-interpret-effects"><i class="fa fa-check"></i><b>3.5.2</b> Substituting in Values for Age to Interpret Effects</a></li>
<li class="chapter" data-level="3.5.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#approximate-interpretation-of-the-slope"><i class="fa fa-check"></i><b>3.5.3</b> Approximate Interpretation of the Slope</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#plotting-the-fitted-model-1"><i class="fa fa-check"></i><b>3.6</b> Plotting the Fitted Model</a></li>
<li class="chapter" data-level="3.7" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#relationship-between-mpaa-rating-and-budget"><i class="fa fa-check"></i><b>3.7</b> Relationship between MPAA Rating and Budget</a><ul>
<li class="chapter" data-level="3.7.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#regression-model"><i class="fa fa-check"></i><b>3.7.1</b> Regression Model</a></li>
<li class="chapter" data-level="3.7.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#mathematical-explanation-1"><i class="fa fa-check"></i><b>3.7.2</b> Mathematical Explanation</a></li>
<li class="chapter" data-level="3.7.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#approximate-interpretations"><i class="fa fa-check"></i><b>3.7.3</b> Approximate Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#multiple-regression-main-effects-model"><i class="fa fa-check"></i><b>3.8</b> Multiple Regression: Main Effects Model</a><ul>
<li class="chapter" data-level="3.8.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#nested-f-test"><i class="fa fa-check"></i><b>3.8.1</b> Nested F-Test</a></li>
<li class="chapter" data-level="3.8.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#coefficient-level-interpretation"><i class="fa fa-check"></i><b>3.8.2</b> Coefficient-Level Interpretation</a></li>
<li class="chapter" data-level="3.8.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#plot-of-the-fitted-model"><i class="fa fa-check"></i><b>3.8.3</b> Plot of the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#multiple-regression-interaction-model"><i class="fa fa-check"></i><b>3.9</b> Multiple Regression: Interaction Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html"><i class="fa fa-check"></i>Log Transformations: Some Final Thoughts</a><ul>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#power-transformations"><i class="fa fa-check"></i>Power Transformations</a><ul>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#ladder-of-transformations"><i class="fa fa-check"></i>Ladder of Transformations</a></li>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#rule-of-the-bulge"><i class="fa fa-check"></i>Rule of the Bulge</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>4</b> Probability Distributions</a><ul>
<li class="chapter" data-level="" data-path="probability-distributions.html"><a href="probability-distributions.html#preparation-3"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="4.1" data-path="probability-distributions.html"><a href="probability-distributions.html#dataset-and-research-question-2"><i class="fa fa-check"></i><b>4.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="4.2" data-path="probability-distributions.html"><a href="probability-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>4.2</b> Normal Distribution</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability-distributions.html"><a href="probability-distributions.html#other-useful-r-functions-for-working-with-probability-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Other Useful R Functions for Working with Probability Distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability-distributions.html"><a href="probability-distributions.html#finding-cumulative-probability"><i class="fa fa-check"></i><b>4.2.2</b> Finding Cumulative Probability</a></li>
<li class="chapter" data-level="4.2.3" data-path="probability-distributions.html"><a href="probability-distributions.html#cumulative-density-and-p-value"><i class="fa fa-check"></i><b>4.2.3</b> Cumulative Density and <span class="math inline">\(p\)</span>-Value</a></li>
<li class="chapter" data-level="4.2.4" data-path="probability-distributions.html"><a href="probability-distributions.html#finding-quantiles"><i class="fa fa-check"></i><b>4.2.4</b> Finding Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability-distributions.html"><a href="probability-distributions.html#students-t-distribution"><i class="fa fa-check"></i><b>4.3</b> Student’s <span class="math inline">\(t\)</span>-Distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability-distributions.html"><a href="probability-distributions.html#comparing-probability-densities"><i class="fa fa-check"></i><b>4.3.1</b> Comparing Probability Densities</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability-distributions.html"><a href="probability-distributions.html#comparing-cumulative-densities"><i class="fa fa-check"></i><b>4.3.2</b> Comparing Cumulative Densities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability-distributions.html"><a href="probability-distributions.html#using-the-t-distribution-in-regression"><i class="fa fa-check"></i><b>4.4</b> Using the <span class="math inline">\(t\)</span>-Distribution in Regression</a></li>
<li class="chapter" data-level="4.5" data-path="probability-distributions.html"><a href="probability-distributions.html#model-level-inference-the-f-distribution"><i class="fa fa-check"></i><b>4.5</b> Model-Level Inference: The <span class="math inline">\(F\)</span>-Distribution</a><ul>
<li class="chapter" data-level="4.5.1" data-path="probability-distributions.html"><a href="probability-distributions.html#testing-the-model-level-null-hypothesis"><i class="fa fa-check"></i><b>4.5.1</b> Testing the Model-Level Null Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="probability-distributions.html"><a href="probability-distributions.html#mean-squares-are-variance-estimates"><i class="fa fa-check"></i><b>4.6</b> Mean Squares are Variance Estimates</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>5</b> Maximum Likelihood Estimation</a><ul>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#preparation-4"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="5.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#dataset-and-research-question-3"><i class="fa fa-check"></i><b>5.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="5.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#joint-probability-density"><i class="fa fa-check"></i><b>5.2</b> Joint Probability Density</a></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#likelihood"><i class="fa fa-check"></i><b>5.3</b> Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood"><i class="fa fa-check"></i><b>5.4</b> Maximum Likelihood</a><ul>
<li class="chapter" data-level="5.4.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#method-1-grid-search"><i class="fa fa-check"></i><b>5.4.1</b> Method 1: Grid Search</a></li>
<li class="chapter" data-level="5.4.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#log-likelihood"><i class="fa fa-check"></i><b>5.4.2</b> Log-Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-regression"><i class="fa fa-check"></i><b>5.5</b> Maximum Likelihood Estimation for Regression</a><ul>
<li class="chapter" data-level="5.5.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#large-search-spaces"><i class="fa fa-check"></i><b>5.5.1</b> Large Search Spaces</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#ml-estimation-in-regression-using-r"><i class="fa fa-check"></i><b>5.6</b> ML Estimation in Regression Using R</a><ul>
<li class="chapter" data-level="5.6.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#using-r-to-directly-compute-the-likelihood-and-log-likelihood"><i class="fa fa-check"></i><b>5.6.1</b> Using R to Directly Compute the Likelihood and Log-Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#way-too-much-math"><i class="fa fa-check"></i><b>5.7</b> Way, Way, Way too Much Mathematics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html"><i class="fa fa-check"></i><b>6</b> Information Criteria for Model Selection</a><ul>
<li class="chapter" data-level="" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#preparation-5"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="6.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#dataset-and-research-question-4"><i class="fa fa-check"></i><b>6.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="6.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#model-building"><i class="fa fa-check"></i><b>6.2</b> Model-Building</a><ul>
<li class="chapter" data-level="6.2.1" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#exploration-of-the-outcome"><i class="fa fa-check"></i><b>6.2.1</b> Exploration of the Outcome</a></li>
<li class="chapter" data-level="6.2.2" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#building-the-student-related-factors-model"><i class="fa fa-check"></i><b>6.2.2</b> Building the Student-Related Factors Model</a></li>
<li class="chapter" data-level="6.2.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#building-the-faculty-related-factors-model"><i class="fa fa-check"></i><b>6.2.3</b> Building the Faculty-Related Factors Model</a></li>
<li class="chapter" data-level="6.2.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#building-the-institution-related-factors-model"><i class="fa fa-check"></i><b>6.2.4</b> Building the Institution-Related Factors Model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#candidate-statistical-models"><i class="fa fa-check"></i><b>6.3</b> Candidate Statistical Models</a></li>
<li class="chapter" data-level="6.4" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#log-likelihood-1"><i class="fa fa-check"></i><b>6.4</b> Log-Likelihood</a></li>
<li class="chapter" data-level="6.5" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#deviance-an-alternative-fit-value"><i class="fa fa-check"></i><b>6.5</b> Deviance: An Alternative Fit Value</a></li>
<li class="chapter" data-level="6.6" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#akiakes-information-criteria-aic"><i class="fa fa-check"></i><b>6.6</b> Akiake’s Information Criteria (AIC)</a></li>
<li class="chapter" data-level="6.7" data-path="information-criteria-for-model-selection.html"><a href="information-criteria-for-model-selection.html#empirical-support-for-hypotheses"><i class="fa fa-check"></i><b>6.7</b> Empirical Support for Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="moreinfocrit.html"><a href="moreinfocrit.html"><i class="fa fa-check"></i><b>7</b> Model Evidence</a><ul>
<li class="chapter" data-level="" data-path="moreinfocrit.html"><a href="moreinfocrit.html#preparation-6"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="7.1" data-path="moreinfocrit.html"><a href="moreinfocrit.html#dataset-and-research-question-5"><i class="fa fa-check"></i><b>7.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="7.2" data-path="moreinfocrit.html"><a href="moreinfocrit.html#corrected-aic-aicc-adjusting-for-model-complexity-and-sample-size"><i class="fa fa-check"></i><b>7.2</b> Corrected AIC (AICc): Adjusting for Model Complexity and Sample Size</a></li>
<li class="chapter" data-level="7.3" data-path="moreinfocrit.html"><a href="moreinfocrit.html#model-selection-uncertainty"><i class="fa fa-check"></i><b>7.3</b> Model-Selection Uncertainty</a></li>
<li class="chapter" data-level="7.4" data-path="moreinfocrit.html"><a href="moreinfocrit.html#relative-likelihood-and-evidence-ratios"><i class="fa fa-check"></i><b>7.4</b> Relative Likelihood and Evidence Ratios</a></li>
<li class="chapter" data-level="7.5" data-path="moreinfocrit.html"><a href="moreinfocrit.html#model-probabilities"><i class="fa fa-check"></i><b>7.5</b> Model Probabilities</a></li>
<li class="chapter" data-level="7.6" data-path="moreinfocrit.html"><a href="moreinfocrit.html#tables-of-model-evidence"><i class="fa fa-check"></i><b>7.6</b> Tables of Model Evidence</a></li>
<li class="chapter" data-level="7.7" data-path="moreinfocrit.html"><a href="moreinfocrit.html#some-final-thoughts"><i class="fa fa-check"></i><b>7.7</b> Some Final Thoughts</a></li>
<li class="chapter" data-level="7.8" data-path="moreinfocrit.html"><a href="moreinfocrit.html#pretty-printing-tables-of-model-evidence"><i class="fa fa-check"></i><b>7.8</b> Pretty Printing Tables of Model Evidence</a></li>
<li class="chapter" data-level="" data-path="moreinfocrit.html"><a href="moreinfocrit.html#other-resources-2"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="intro-lmer.html"><a href="intro-lmer.html"><i class="fa fa-check"></i><b>8</b> Introduction to Mixed-Effects Models</a><ul>
<li class="chapter" data-level="" data-path="intro-lmer.html"><a href="intro-lmer.html#preparation-7"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="8.1" data-path="intro-lmer.html"><a href="intro-lmer.html#dataset-and-research-question-6"><i class="fa fa-check"></i><b>8.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="8.2" data-path="intro-lmer.html"><a href="intro-lmer.html#merge-the-player--and-team-level-data"><i class="fa fa-check"></i><b>8.2</b> Merge the Player- and Team-Level Data</a></li>
<li class="chapter" data-level="8.3" data-path="intro-lmer.html"><a href="intro-lmer.html#fixed-effects-regression-model"><i class="fa fa-check"></i><b>8.3</b> Fixed-Effects Regression Model</a><ul>
<li class="chapter" data-level="8.3.1" data-path="intro-lmer.html"><a href="intro-lmer.html#residual-analysis"><i class="fa fa-check"></i><b>8.3.1</b> Residual Analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="intro-lmer.html"><a href="intro-lmer.html#conceptual-idea-of-mixed-effects-models"><i class="fa fa-check"></i><b>8.4</b> Conceptual Idea of Mixed-Effects Models</a></li>
<li class="chapter" data-level="8.5" data-path="intro-lmer.html"><a href="intro-lmer.html#fitting-the-mixed-effects-regression-model-in-practice"><i class="fa fa-check"></i><b>8.5</b> Fitting the Mixed-Effects Regression Model in Practice</a></li>
<li class="chapter" data-level="" data-path="intro-lmer.html"><a href="intro-lmer.html#other-resources-3"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html"><i class="fa fa-check"></i>Data Codebooks</a><ul>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#ed-schools-2018"><i class="fa fa-check"></i>ed-schools-2018.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#evaluations"><i class="fa fa-check"></i>evaluations.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#fci-2018"><i class="fa fa-check"></i>fci-2015.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#mn-schools"><i class="fa fa-check"></i>mn-schools.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#movies"><i class="fa fa-check"></i>movies.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#nba"><i class="fa fa-check"></i>nba-level-01.sav and nba-level-02.sav</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#popular"><i class="fa fa-check"></i>popular-classroom.csv and popular-student.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#riverview"><i class="fa fa-check"></i>riverview.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#wine"><i class="fa fa-check"></i>wine.csv</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EPsy 8252 Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro-lmer" class="section level1">
<h1><span class="header-section-number">Unit 8:</span> Introduction to Mixed-Effects Models</h1>
<p>In this set of notes, you will learn more about using information criteria to select a model from a set of candidate models.</p>
<hr />
<div id="preparation-7" class="section level3 unnumbered">
<h3>Preparation</h3>
<p>Before class you will need read the following:</p>
<ul>
<li>Burnham, K. P., Anderson, D. R., &amp; Huyvaert, K. P. (2010). <a href="https://link-springer-com.ezp3.lib.umn.edu/article/10.1007/s00265-010-1029-6">AIC model selection and multimodel inference in behavioral ecology: Some background, observations, and comparisons</a>. <em>Behavioral Ecology and Sociobiology, 65</em>(1), 23–35.</li>
</ul>
<p><br /></p>
<hr />
</div>
<div id="dataset-and-research-question-6" class="section level2">
<h2><span class="header-section-number">8.1</span> Dataset and Research Question</h2>
<p>In this set of notes, we will use data from two files, the <em>nba-level-01.csv</em> file and the <em>nba-level-02.csv</em> file (see the <a href="data-codebook.html#nba">data codebook</a> here). These data include player-level attributes for <span class="math inline">\(n=300\)</span> NBA players, and team-level attributes for <span class="math inline">\(N=30\)</span> different teams..</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load libraries</span>
<span class="kw">library</span>(AICcmodavg)
<span class="kw">library</span>(arm)
<span class="kw">library</span>(broom)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lme4) <span class="co">#for fitting mixed-effects models</span>
<span class="kw">library</span>(readr)
<span class="kw">library</span>(sm)

<span class="co"># Read in player-level data</span>
nba_players =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;~/Documents/github/epsy-8252/data/nba-players.csv&quot;</span>)
<span class="kw">head</span>(nba_players)</code></pre>
<pre><code># A tibble: 6 x 3
   team success life_satisfaction
  &lt;dbl&gt;   &lt;dbl&gt;             &lt;dbl&gt;
1     1       3              18.8
2     1       3              18  
3     1       4              21  
4     1       4              20.5
5     1       3              19  
6     1       2              12.1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in team-level data</span>
nba_teams =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;~/Documents/github/epsy-8252/data/nba-teams.csv&quot;</span>)
<span class="kw">head</span>(nba_teams)</code></pre>
<pre><code># A tibble: 6 x 2
   team coach_experience
  &lt;dbl&gt;            &lt;dbl&gt;
1     1                2
2     2                3
3     3                2
4     4                2
5     5                1
6     6                2</code></pre>
<p>We will use these data to explore the question of whether player success predicts variation in life satisfaction.</p>
</div>
<div id="merge-the-player--and-team-level-data" class="section level2">
<h2><span class="header-section-number">8.2</span> Merge the Player- and Team-Level Data</h2>
<p>Before analyzing the data, we need to merge, or join, the two datasets together. To do this, we will use the <code>left_join()</code> function from the <strong>dplyr</strong> package. <strong>dplyr</strong> includes six different join functions. You can read about several different join functions <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/two-table.html">here</a>.</p>
<pre class="sourceCode r"><code class="sourceCode r">nba =<span class="st"> </span><span class="kw">left_join</span>(nba_players, nba_teams, <span class="dt">by =</span> <span class="st">&quot;team&quot;</span>)
<span class="kw">head</span>(nba)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["team"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["success"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["life_satisfaction"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["coach_experience"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"3","3":"18.804","4":"2"},{"1":"1","2":"3","3":"18.000","4":"2"},{"1":"1","2":"4","3":"21.000","4":"2"},{"1":"1","2":"4","3":"20.500","4":"2"},{"1":"1","2":"3","3":"19.000","4":"2"},{"1":"1","2":"2","3":"12.100","4":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="fixed-effects-regression-model" class="section level2">
<h2><span class="header-section-number">8.3</span> Fixed-Effects Regression Model</h2>
<p>To examine the research question of whether player success predicts variation in life satisfaction, we might regress life satisfaction on the success variable using the <code>lm()</code> function. The <code>lm()</code> function fits a <em>fixed-effects regression model</em>.</p>
<pre class="sourceCode r"><code class="sourceCode r">lm<span class="fl">.1</span> =<span class="st"> </span><span class="kw">lm</span>(life_satisfaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>success, <span class="dt">data =</span> nba)

<span class="co"># Model-level output</span>
<span class="kw">glance</span>(lm<span class="fl">.1</span>)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["int"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"0.7954431","2":"0.7947566","3":"2.444498","4":"1158.807","5":"1.059518e-104","6":"2","7":"-692.8301","8":"1391.66","9":"1402.772","10":"1780.72","11":"298"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient-level output</span>
<span class="kw">tidy</span>(lm<span class="fl">.1</span>)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"5.693659","3":"0.3026293","4":"18.81397","5":"1.363463e-52"},{"1":"success","2":"3.659844","3":"0.1075120","4":"34.04126","5":"1.059518e-104"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>To have faith in the analytic results from this model, we need to evaluate whether the assumptions are satisfied.</p>
<div id="residual-analysis" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Residual Analysis</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtain the fortified data frame</span>
out =<span class="st"> </span><span class="kw">augment</span>(lm<span class="fl">.1</span>)
<span class="kw">head</span>(out)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["life_satisfaction"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["success"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".se.fit"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"18.804","2":"3","3":"16.67319","4":"0.1514101","5":"2.1308104","6":"0.003836457","7":"2.445474","8":"1.468755e-03","9":"0.87335305"},{"1":"18.000","2":"3","3":"16.67319","4":"0.1514101","5":"1.3268096","6":"0.003836457","7":"2.447394","8":"5.694780e-04","9":"0.54381806"},{"1":"21.000","2":"4","3":"20.33303","4":"0.2151136","5":"0.6669657","6":"0.007743841","7":"2.448301","8":"2.927564e-04","9":"0.27390624"},{"1":"20.500","2":"4","3":"20.33303","4":"0.2151136","5":"0.1669657","6":"0.007743841","7":"2.448590","8":"1.834653e-05","9":"0.06856866"},{"1":"19.000","2":"3","3":"16.67319","4":"0.1514101","5":"2.3268096","6":"0.003836457","7":"2.444870","8":"1.751384e-03","9":"0.95368701"},{"1":"12.100","2":"2","3":"13.01335","4":"0.1506448","5":"-0.9133465","6":"0.003797770","7":"2.448034","8":"2.671133e-04","9":"-0.37434510"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Normality</span>
<span class="kw">sm.density</span>(out<span class="op">$</span>.std.resid, <span class="dt">model =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Standardized residuals&quot;</span>)

<span class="co"># All other assumptions</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> out, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .std.resid)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted values&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Standardized residuals&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-6"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-6-1.png" alt="Density plot of the standardized residuals and scatterplot of the standardized residuals versus the fitted values from the fixed-effects regression model." width="50%" /><img src="epsy-8252-notes_files/figure-html/unnamed-chunk-6-2.png" alt="Density plot of the standardized residuals and scatterplot of the standardized residuals versus the fitted values from the fixed-effects regression model." width="50%" />
<p class="caption">
Figure 8.1: Density plot of the standardized residuals and scatterplot of the standardized residuals versus the fitted values from the fixed-effects regression model.
</p>
</div>
<p>The assumptions of linearity, normality, and homoscedasticity seem reasonably satisfied. The assumption of independnece, however, is probably not tenable. The life satisfaction scores (and thus the residuals) are probably more correlated within teams than between teams—this is a violation of independence. If we have a variable that identifies team, we can actually examine this by plotting the residuals separately for each team.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add team ID variable to augmented data</span>
out<span class="op">$</span>team =<span class="st"> </span>nba<span class="op">$</span>team

<span class="co">### Show residuals by team</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> out, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .std.resid)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted values&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Studentized residuals&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>team, <span class="dt">nrow =</span> <span class="dv">5</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-7-1.png" alt="Scatterplots of the standardized residuals versus the fitted values from the fixed-effects regression model stratified by team." width="90%" />
<p class="caption">
Figure 8.2: Scatterplots of the standardized residuals versus the fitted values from the fixed-effects regression model stratified by team.
</p>
</div>
<p>The residuals show a systematic (non-random) pattern within teams (e.g., Team 02, Team 28). This is a sign of non-independence of the residuals. To account for this we need to use a statistical model that accounts for the correlation among the residuals within teams. This is what <em>mixed-effects models</em> bring to the table. By correctly modeling the non-independence, we get more accurate standard errors and <em>p</em>-values.</p>
<p>Another benefit of using mixed-effects models is that we also get estimates of the variation accounted for at both the team- and player-levels. This disaggregating of the variation allows us to see which level is explaining more variation and to study predictors appropriate to explaining that variation. For example, suppose that in an educational study you disaggregated the variation in student achievement scores and found that:</p>
<ul>
<li>96% of the variation in these scores was at the student-level, and</li>
<li>3% of the variation in these scores was at the classroom-level, and</li>
<li>1% of the variation in these scores was at the school-level.</li>
</ul>
<p>By including school-level or classroom-level predictors in the model, you would only be “chipping away” at that 1% or 3%, respectively. You should focus your attention and resources on student-level predictors!</p>
</div>
</div>
<div id="conceptual-idea-of-mixed-effects-models" class="section level2">
<h2><span class="header-section-number">8.4</span> Conceptual Idea of Mixed-Effects Models</h2>
<p>In this section we will outline the conceptual ideas behind mixed-effects models by linking the ideas behind these models to the conventional, fixed-effects regression model. <em>It is important to realize that this is just conceptual in nature. Its purpose is only to help you understand the output you get from a mixed-effects model analysis.</em></p>
<p>To begin, we remind you of the fitted equation we obtained earlier from the fixed-effects regression:</p>
<p><span class="math display">\[
\hat{\mathrm{Life~Satisfaction}_i} = 5.70 + 3.66(\mathrm{Player~Success}_i)
\]</span></p>
<p>Mixed-effects regression actually fits a global model (like the one above) AND a team-specific model for each team. Conceptually this is akin to fitting a regression model for each team separately. Below I will do this, but keep in mind that this is only to help you understand.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit team models</span>
team_models =<span class="st"> </span>nba <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(team) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">do</span>( <span class="dt">mod =</span> <span class="kw">lm</span>(life_satisfaction <span class="op">~</span><span class="st"> </span>success, <span class="dt">data =</span> .) ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">tidy</span>(mod)

<span class="co"># View coefficients from fitted models</span>
team_models</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["team"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["term"],"name":[2],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"(Intercept)","3":"4.7259001","4":"3.0408175","5":"1.5541545","6":"1.587542e-01"},{"1":"1","2":"success","3":"3.9775000","4":"0.9918053","5":"4.0103637","6":"3.893084e-03"},{"1":"2","2":"(Intercept)","3":"9.9555372","4":"1.8031076","5":"5.5213217","6":"5.595109e-04"},{"1":"2","2":"success","3":"2.9666116","4":"0.4671201","5":"6.3508546","6":"2.204084e-04"},{"1":"3","2":"(Intercept)","3":"9.0336364","4":"1.5037390","5":"6.0074497","6":"3.207207e-04"},{"1":"3","2":"success","3":"3.2004132","4":"0.4322946","5":"7.4033158","6":"7.595398e-05"},{"1":"4","2":"(Intercept)","3":"5.6576796","4":"1.2571223","5":"4.5005007","6":"2.000768e-03"},{"1":"4","2":"success","3":"3.3752486","4":"0.3527570","5":"9.5681971","6":"1.178981e-05"},{"1":"5","2":"(Intercept)","3":"7.0408571","4":"1.2505969","5":"5.6299972","6":"4.927339e-04"},{"1":"5","2":"success","3":"2.3347619","4":"0.6884309","5":"3.3914250","6":"9.479950e-03"},{"1":"6","2":"(Intercept)","3":"4.6310638","4":"1.5745189","5":"2.9412564","6":"1.867372e-02"},{"1":"6","2":"success","3":"4.1888652","4":"0.5338119","5":"7.8470809","6":"5.016319e-05"},{"1":"7","2":"(Intercept)","3":"6.9032653","4":"1.2363674","5":"5.5835065","6":"5.201649e-04"},{"1":"7","2":"success","3":"1.1661224","4":"0.9482505","5":"1.2297620","6":"2.537227e-01"},{"1":"8","2":"(Intercept)","3":"6.1158621","4":"2.5704276","5":"2.3793170","6":"4.459319e-02"},{"1":"8","2":"success","3":"3.6568966","4":"0.6944566","5":"5.2658391","6":"7.591110e-04"},{"1":"9","2":"(Intercept)","3":"8.9687755","4":"2.1624312","5":"4.1475427","6":"3.219825e-03"},{"1":"9","2":"success","3":"1.5395918","4":"1.0679486","5":"1.4416347","6":"1.873805e-01"},{"1":"10","2":"(Intercept)","3":"5.6341035","4":"1.9798660","5":"2.8456994","6":"2.162158e-02"},{"1":"10","2":"success","3":"3.5268621","4":"0.8082769","5":"4.3634330","6":"2.401553e-03"},{"1":"11","2":"(Intercept)","3":"3.6982759","4":"1.2383586","5":"2.9864338","6":"1.742849e-02"},{"1":"11","2":"success","3":"4.1339655","4":"0.5055578","5":"8.1770388","6":"3.728984e-05"},{"1":"12","2":"(Intercept)","3":"3.0890000","4":"1.7136231","5":"1.8026134","6":"1.091162e-01"},{"1":"12","2":"success","3":"4.9025000","4":"0.7821584","5":"6.2679122","6":"2.409914e-04"},{"1":"13","2":"(Intercept)","3":"16.2468966","4":"2.8606830","5":"5.6793768","6":"4.653269e-04"},{"1":"13","2":"success","3":"1.0831034","4":"0.7266142","5":"1.4906170","6":"1.743970e-01"},{"1":"14","2":"(Intercept)","3":"8.1723333","4":"0.8486189","5":"9.6301566","6":"1.123817e-05"},{"1":"14","2":"success","3":"0.4166667","4":"0.6708922","5":"0.6210635","6":"5.518383e-01"},{"1":"15","2":"(Intercept)","3":"12.5200000","4":"4.1249100","5":"3.0352177","6":"1.618051e-02"},{"1":"15","2":"success","3":"0.6525000","4":"1.6839875","5":"0.3874732","6":"7.085110e-01"},{"1":"16","2":"(Intercept)","3":"6.2700000","4":"2.4210500","5":"2.5897854","6":"3.212383e-02"},{"1":"16","2":"success","3":"3.5700000","4":"1.0617007","5":"3.3625296","6":"9.894585e-03"},{"1":"17","2":"(Intercept)","3":"7.3907143","4":"1.1344751","5":"6.5146556","6":"1.852233e-04"},{"1":"17","2":"success","3":"1.2510714","4":"0.8021950","5":"1.5595602","6":"1.574834e-01"},{"1":"18","2":"(Intercept)","3":"9.9685366","4":"1.7730394","5":"5.6222872","6":"4.971710e-04"},{"1":"18","2":"success","3":"2.5471951","4":"0.4880130","5":"5.2195228","6":"8.030526e-04"},{"1":"19","2":"(Intercept)","3":"5.8455000","4":"2.1282616","5":"2.7466078","6":"2.519063e-02"},{"1":"19","2":"success","3":"3.4590000","4":"0.8044073","5":"4.3000605","6":"2.615541e-03"},{"1":"20","2":"(Intercept)","3":"6.2084564","4":"1.1819558","5":"5.2526975","6":"7.713052e-04"},{"1":"20","2":"success","3":"3.6644966","4":"0.5233788","5":"7.0016141","6":"1.124572e-04"},{"1":"21","2":"(Intercept)","3":"6.3113793","4":"1.3386534","5":"4.7147226","6":"1.512427e-03"},{"1":"21","2":"success","3":"3.7803448","4":"0.6381780","5":"5.9236531","6":"3.522418e-04"},{"1":"22","2":"(Intercept)","3":"8.0525000","4":"1.7228713","5":"4.6738836","6":"1.594467e-03"},{"1":"22","2":"success","3":"1.8375000","4":"0.8838143","5":"2.0790566","6":"7.121955e-02"},{"1":"23","2":"(Intercept)","3":"11.8758621","4":"1.6948386","5":"7.0070755","6":"1.118462e-04"},{"1":"23","2":"success","3":"2.2668966","4":"0.4578973","5":"4.9506661","6":"1.119946e-03"},{"1":"24","2":"(Intercept)","3":"7.0228571","4":"0.9116329","5":"7.7036024","6":"5.724545e-05"},{"1":"24","2":"success","3":"1.0928571","4":"0.6991905","5":"1.5630320","6":"1.566722e-01"},{"1":"25","2":"(Intercept)","3":"5.7506577","4":"2.1860047","5":"2.6306703","6":"3.014679e-02"},{"1":"25","2":"success","3":"3.2918523","4":"0.6561296","5":"5.0170767","6":"1.030626e-03"},{"1":"26","2":"(Intercept)","3":"7.2809615","4":"1.7633198","5":"4.1291214","6":"3.302449e-03"},{"1":"26","2":"success","3":"2.1428846","4":"1.0180532","5":"2.1048848","6":"6.841565e-02"},{"1":"27","2":"(Intercept)","3":"2.8625000","4":"2.8361003","5":"1.0093085","6":"3.423759e-01"},{"1":"27","2":"success","3":"4.5225000","4":"0.9059590","5":"4.9919477","6":"1.063475e-03"},{"1":"28","2":"(Intercept)","3":"7.0252308","4":"1.8106848","5":"3.8798751","6":"4.675611e-03"},{"1":"28","2":"success","3":"3.7530769","4":"0.5041363","5":"7.4445676","6":"7.302178e-05"},{"1":"29","2":"(Intercept)","3":"16.4887755","4":"3.6970346","5":"4.4600004","6":"2.111063e-03"},{"1":"29","2":"success","3":"1.3087755","4":"0.9330474","5":"1.4026893","6":"1.983048e-01"},{"1":"30","2":"(Intercept)","3":"9.8260526","4":"2.4663778","5":"3.9840015","6":"4.039034e-03"},{"1":"30","2":"success","3":"2.4260526","4":"0.8410278","5":"2.8846282","6":"2.036634e-02"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As an example, let’s focus on the fitted model for Team 01.</p>
<p><span class="math display">\[
\hat{\mathrm{Life~Satisfaction}_i} = 4.73 + 3.98(\mathrm{Player~Success}_i)
\]</span></p>
<p>Comparing this team-specific model to the global model, we find that Team 01’s intercept is lower than the intercept from the global model (by 0.97) and it’s slope is higher than the slope from the global model (by 0.32). We can actually re-write Team 01’s team-specific model using these ideas:</p>
<p><span class="math display">\[
\hat{\mathrm{Life~Satisfaction}_i} = \bigg[5.70 - 0.97\bigg] + \bigg[3.66 + 0.32\bigg](\mathrm{Player~Success}_i)
\]</span></p>
<p>In the language of mixed-effects modeling:</p>
<ul>
<li>The global intercept and slope are referred to as <em>fixed-effects</em>. These are also sometimes referred to as <em>between-groups</em> effects.
<ul>
<li>The fixed-effect of intercept is <span class="math inline">\(5.70\)</span>; and</li>
<li>The fixed effect of the slope is <span class="math inline">\(3.66\)</span>.</li>
</ul></li>
<li>The team-specific deviations from the fixed-effect values are referred to as <em>random-effects</em>. These are also sometimes referred to as <em>within-groups</em> effects.
<ul>
<li>The random-effect of the intercept for Team 01 is <span class="math inline">\(-0.97\)</span>; and</li>
<li>The random-effect of the slope for Team 01 is <span class="math inline">\(+0.32\)</span>.</li>
</ul></li>
</ul>
<p>Note, each team could potentially have a different random-effect for intercept and slope. For example, writing the team-specific fitted equation for Team 02 in this manner,</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Life~Satisfaction}_i} &amp;= 9.96 + 2.97(\mathrm{Player~Success}_i)\\
 &amp;= \bigg[5.70 + 4.26 \bigg] + \bigg[3.66 + 0.69\bigg](\mathrm{Player~Success}_i),\\
\end{split} 
\]</span></p>
<p>we find that:</p>
<ul>
<li>The fixed-effects (global model effects) are the same as they were for Team 01.</li>
<li>The random-effect of intercept for Team 02 is <span class="math inline">\(4.26\)</span>.</li>
<li>The random-effect of slope for Team 02 is <span class="math inline">\(0.69\)</span>.</li>
</ul>
</div>
<div id="fitting-the-mixed-effects-regression-model-in-practice" class="section level2">
<h2><span class="header-section-number">8.5</span> Fitting the Mixed-Effects Regression Model in Practice</h2>
<p>In practice, we use the <code>lmer()</code> function from the <strong>lme4</strong> library to fit mixed-effect regression models. This function will essentially do what we did in the previous section, but rather than independently fitting the team-specific models, it will fit all these models simultaneously and make use of the information in all the clusters (teams) to do this. This will result in better estimates for both the fixed- and random-effects.</p>
<p>The syntax looks similar to the syntax we use in <code>lm()</code> except now we split it into two parts. The first part of the syntax gives a model formula to specify the outcome and fixed-effects included in the model. This is identical to the syntax we used in the <code>lm()</code> function. In our example: <code>Life_Satisfaction ~ 1 + Shots_on_five</code> indicating that we want to fit a model that includes fixed-effects for both the intercept and the slope (the fixed-effect of player success).</p>
<p>We also have to declare that we want random-effects for these two coefficients. The second part of the syntax declares this: <code>(1 + Shots_on_five | Team_ID)</code>. This says fit random-effects for the intercept and slope and do so for each team. This is literally added (using <code>+</code>) to the fixed-effects formula.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit mixed-effects regression model</span>
lmer<span class="fl">.1</span> =<span class="st"> </span><span class="kw">lmer</span>(life_satisfaction <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>success <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>success <span class="op">|</span><span class="st"> </span>team), <span class="dt">data =</span> nba)</code></pre>
<p>To view the fixed-effects, we use the <code>fixef()</code> function.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># View fixed-effects (global effects)</span>
<span class="kw">fixef</span>(lmer<span class="fl">.1</span>)</code></pre>
<pre><code>(Intercept)     success 
   6.429643    3.288667 </code></pre>
<p>To view the team-specific random-effects, we use the <code>ranef()</code> function (only the first 6 rows are shown).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># View random-effects (team-specific effects)</span>
<span class="kw">ranef</span>(lmer<span class="fl">.1</span>)</code></pre>
<pre><code>$team
   (Intercept)     success
1   0.07792006  0.08053479
2   0.36112543  0.37324356
3   0.38440610  0.39730545
4  -0.07373230 -0.07620650
5  -0.23807522 -0.24606421
     ...
30  0.14632753  0.15123778</code></pre>
<p>From these two sets of information, we can re-construct each team-specific fitted equation if we are so inclined. For example, we first write the fitted equation for the fixed-effects (global equation):</p>
<p><span class="math display">\[
\hat{\mathrm{Life~Satisfaction}_i} = 6.43 + 3.29(\mathrm{Player~Success}_i)
\]</span></p>
<p>To construct the team-specific fitted equation for Team 30, we add the estimated random-effects for Team 30 to the respective fixed-effects from the global model:</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Life~Satisfaction}_i} &amp;= \bigg[6.43 + 0.1463 \bigg] + \bigg[3.29 + 0.1512\bigg](\mathrm{Player~Success}_i)\\
&amp;= 6.58 + 3.44(\mathrm{Player~Success}_i)\\
\end{split} 
\]</span></p>
</div>
<div id="other-resources-3" class="section level2 unnumbered">
<h2>Other Resources</h2>
<p>In addition to the notes and what we cover in class, there many other resources for learning information criteria for model selection. Here are some resources that may be helpful in that endeavor:</p>
<ul>
<li>Anderson, David R. (2008). <a href="https://link-springer-com.ezp3.lib.umn.edu/book/10.1007%2F978-0-387-74075-1">Model based inference in the life sciences: A primer on evidence</a>. New York: Springer.</li>
<li>Burnham, Kenneth P., &amp; Anderson, David R. (2002). <a href="http://ecologia.ib.usp.br/bie5782/lib/exe/fetch.php?media=bie5782:pdfs:burnham_anderson2002.pdf">Model selection and multimodel inference: A practical information-theoretic approach</a>. New York: Springer.</li>
</ul>
<p><br /></p>
<p>For <strong>table formatting</strong> using R Markdown, check out:</p>
<ul>
<li><a href="https://haozhu233.github.io/kableExtra/">kableExtra Documentation</a></li>
<li><a href="https://gt.rstudio.com/">gt Documentation</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="moreinfocrit.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-codebook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {},
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"collapse": "section",
"toolbar": null,
"position": "fixed",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
