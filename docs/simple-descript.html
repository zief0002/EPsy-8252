<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>EPsy 8252 Notes</title>
  <meta name="description" content="These are the notes for EPsy 8252.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="EPsy 8252 Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the notes for EPsy 8252." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="EPsy 8252 Notes" />
  
  <meta name="twitter:description" content="These are the notes for EPsy 8252." />
  

<meta name="author" content="Andrew Zieffler">


<meta name="date" content="2018-12-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="literature.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPsy 8252 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-content"><i class="fa fa-check"></i>Course Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books-and-other-reading-materials"><i class="fa fa-check"></i>Books and Other Reading Materials</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="simple-descript.html"><a href="simple-descript.html"><i class="fa fa-check"></i><b>1</b> Simple Linear Regression—Description</a><ul>
<li class="chapter" data-level="1.1" data-path="simple-descript.html"><a href="simple-descript.html#preparation"><i class="fa fa-check"></i><b>1.1</b> Preparation</a></li>
<li class="chapter" data-level="1.2" data-path="simple-descript.html"><a href="simple-descript.html#data-exploration"><i class="fa fa-check"></i><b>1.2</b> Data Exploration</a><ul>
<li class="chapter" data-level="1.2.1" data-path="simple-descript.html"><a href="simple-descript.html#income"><i class="fa fa-check"></i><b>1.2.1</b> Income</a></li>
<li class="chapter" data-level="1.2.2" data-path="simple-descript.html"><a href="simple-descript.html#education-level"><i class="fa fa-check"></i><b>1.2.2</b> Education Level</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="simple-descript.html"><a href="simple-descript.html#relationship-between-variables"><i class="fa fa-check"></i><b>1.3</b> Relationship Between Variables</a><ul>
<li class="chapter" data-level="1.3.1" data-path="simple-descript.html"><a href="simple-descript.html#scatterplot"><i class="fa fa-check"></i><b>1.3.1</b> Scatterplot</a></li>
<li class="chapter" data-level="1.3.2" data-path="simple-descript.html"><a href="simple-descript.html#correlation"><i class="fa fa-check"></i><b>1.3.2</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simple-descript.html"><a href="simple-descript.html#statistical-model"><i class="fa fa-check"></i><b>1.4</b> Statistical Model</a><ul>
<li class="chapter" data-level="1.4.1" data-path="simple-descript.html"><a href="simple-descript.html#fitted-regression-equation"><i class="fa fa-check"></i><b>1.4.1</b> Fitted Regression Equation</a></li>
<li class="chapter" data-level="1.4.2" data-path="simple-descript.html"><a href="simple-descript.html#errors"><i class="fa fa-check"></i><b>1.4.2</b> Errors</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="simple-descript.html"><a href="simple-descript.html#details-about-the-regression-model"><i class="fa fa-check"></i><b>1.5</b> Details about the Regression Model</a><ul>
<li class="chapter" data-level="1.5.1" data-path="simple-descript.html"><a href="simple-descript.html#notation"><i class="fa fa-check"></i><b>1.5.1</b> Notation</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="simple-descript.html"><a href="simple-descript.html#estimating-the-regression-coefficients-using-r"><i class="fa fa-check"></i><b>1.6</b> Estimating the Regression Coefficients Using R</a><ul>
<li class="chapter" data-level="1.6.1" data-path="simple-descript.html"><a href="simple-descript.html#intercept-interpretation"><i class="fa fa-check"></i><b>1.6.1</b> Intercept Interpretation</a></li>
<li class="chapter" data-level="1.6.2" data-path="simple-descript.html"><a href="simple-descript.html#slope-interpretation"><i class="fa fa-check"></i><b>1.6.2</b> Slope Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="simple-descript.html"><a href="simple-descript.html#using-the-regression-equation"><i class="fa fa-check"></i><b>1.7</b> Using the Regression Equation</a></li>
<li class="chapter" data-level="1.8" data-path="simple-descript.html"><a href="simple-descript.html#conditional-averages"><i class="fa fa-check"></i><b>1.8</b> Conditional Averages</a><ul>
<li class="chapter" data-level="1.8.1" data-path="simple-descript.html"><a href="simple-descript.html#intercept-re-visited"><i class="fa fa-check"></i><b>1.8.1</b> Intercept (Re-visited)</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="simple-descript.html"><a href="simple-descript.html#slope-re-visited"><i class="fa fa-check"></i><b>1.9</b> Slope (Re-visited)</a></li>
<li class="chapter" data-level="1.10" data-path="simple-descript.html"><a href="simple-descript.html#revisiting-the-statistical-model"><i class="fa fa-check"></i><b>1.10</b> Revisiting the Statistical Model</a></li>
<li class="chapter" data-level="1.11" data-path="simple-descript.html"><a href="simple-descript.html#one-more-example"><i class="fa fa-check"></i><b>1.11</b> One More Example</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>2</b> Literature</a></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Methods</a></li>
<li class="chapter" data-level="4" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>4</b> Applications</a><ul>
<li class="chapter" data-level="4.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="6" data-path="data-codebook.html"><a href="data-codebook.html"><i class="fa fa-check"></i><b>6</b> Data Codebooks</a><ul>
<li class="chapter" data-level="6.1" data-path="data-codebook.html"><a href="data-codebook.html#ed-schools"><i class="fa fa-check"></i><b>6.1</b> ed-schools.csv</a></li>
<li class="chapter" data-level="6.2" data-path="data-codebook.html"><a href="data-codebook.html#riverview"><i class="fa fa-check"></i><b>6.2</b> riverview.csv</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EPsy 8252 Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-descript" class="section level1">
<h1><span class="header-section-number">Unit 1</span> Simple Linear Regression—Description</h1>
<p>In this set of notes, you will begin your foray into regression analysis. To do so, we will use the <em>riverview.csv</em> data (see the <a href="data-codebook.html#riverview">data codebook</a> here) to examine whether education level is related to income for the sample of <span class="math inline">\(n=32\)</span> employees working for the city of Riverview.</p>
<div id="preparation" class="section level2">
<h2><span class="header-section-number">1.1</span> Preparation</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Load libraries</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(corrr)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">library</span>(sm)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Read in data</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">city =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;~/Documents/github/epsy-8251/data/riverview.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="kw">head</span>(city)</a></code></pre></div>
<pre><code># A tibble: 6 x 6
  education income seniority gender  male party      
      &lt;int&gt;  &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;      
1         8   37.4         7 male       1 Democrat   
2         8   26.4         9 female     0 Independent
3        10   47.0        14 male       1 Democrat   
4        10   34.2        16 female     0 Independent
5        10   25.5         1 female     0 Republican 
6        12   46.5        11 female     0 Democrat   </code></pre>
</div>
<div id="data-exploration" class="section level2">
<h2><span class="header-section-number">1.2</span> Data Exploration</h2>
<p>Any analysis should start with an initial exploration of the data. During this exploration, you should examine each of the variables that you will be including in the regression analysis. This will help you understand results you get in later analyses, and will also help foreshadow potential problems with the analysis. For additional detail, <a href="https://www.analyticsvidhya.com/blog/2016/01/guide-data-exploration/">this blog post</a> describes initial ideas of data exploration reasonably well. You could also refer to almost any introductory statistics text.</p>
<p>It is typical to begin by exploring the distribution of each variable separately. These distributions are referred to as <em>marginal distributions</em>. After that, it is appropriate to explore the relationships between the variables.</p>
<div id="income" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Income</h3>
<p>To begin this exploration, we will examine the marginal distribution of employees’ incomes. We can plot a marginal distribution using the <code>sm.density()</code> function from the <strong>sm</strong> package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">sm.density</span>(city<span class="op">$</span>income, <span class="dt">xlab =</span> <span class="st">&quot;Income&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-3-1.png" alt="Density plot of employee incomes." width="50%" />
<p class="caption">
Figure 1.1: Density plot of employee incomes.
</p>
</div>
<p>This plot suggests that employees’ incomes are unimodal with most incomes between roughly $50,000 and $70,000. The rug at the bottom of the plot (the small vertical line segments) show the 32 incomes from our sample. The smallest income in the sample is about $25,000 and the largest income is over $80,000. (We could find the exact values using the <code>summary()</code> function.) This suggests there is a fair amount of variation in the data.</p>
<p>To further summarize the distribution, it is typical to compute and report summary statistics such as the mean and standard deviation. One way to compute these values is to use functions from the <strong>dplyr</strong> library.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">city <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">    <span class="dt">M =</span> <span class="kw">mean</span>(income), </a>
<a class="sourceLine" id="cb5-4" data-line-number="4">    <span class="dt">SD =</span> <span class="kw">sd</span>(income)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1  53.7  14.6</code></pre>
<p>Describing this variable we might write,</p>
<blockquote>
<p>The marginal distribution of income is unimodal with a mean of 53.74 thousand dollars. There is variation in employees’ salaries (SD = 14.55 thousand dollars).</p>
</blockquote>
</div>
<div id="education-level" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Education Level</h3>
<p>We will also examine the distribution of the education level variable.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">sm.density</span>(city<span class="op">$</span>education, <span class="dt">xlab =</span> <span class="st">&quot;Education Level&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-5-1.png" alt="Density plot of employee education levels." width="50%" />
<p class="caption">
Figure 1.2: Density plot of employee education levels.
</p>
</div>
<p>Computing the mean and standard deviation:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Summary statistics</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">city <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    <span class="dt">M =</span> <span class="kw">mean</span>(education), </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="dt">SD =</span> <span class="kw">sd</span>(education)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1    16  4.36</code></pre>
<p>Again, we might write,</p>
<blockquote>
<p>The marginal distribution of education is unimodal with a mean of 16 years. There is variation in employees’ level of education (SD = 4.4).</p>
</blockquote>
</div>
</div>
<div id="relationship-between-variables" class="section level2">
<h2><span class="header-section-number">1.3</span> Relationship Between Variables</h2>
<p>Although examining the marginal distributions is an important first step in the analysis, those descriptions do not help us directly answer our research question. To better understand the relationship between income and education level we need to explore the distribution of income (<span class="math inline">\(Y\)</span>) as a function of education (<span class="math inline">\(X\)</span>). To do this, we will create a scatterplot of incomes versus education.</p>
<div id="scatterplot" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Scatterplot</h3>
<p>Below, we use <code>ggplot()</code> to create a scatterplot.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> city, <span class="kw">aes</span>(<span class="dt">x =</span> education, <span class="dt">y =</span> income)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Education (in years)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Income (in thousands of U.S. dollars)&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-7-1.png" alt="Scatterplot displaying the relationship between employee education levels and incomes." width="50%" />
<p class="caption">
Figure 1.3: Scatterplot displaying the relationship between employee education levels and incomes.
</p>
</div>
<p>The plot suggests a relationship (at least for these employees) between level of education and income. When describing the relationship we want to touch on four characteristics of the relationship:</p>
<ul>
<li>Functional form (structure) of the relationship</li>
<li>Direction</li>
<li>Strength</li>
<li>Observations that do not fit the trend (outliers)</li>
</ul>
</div>
<div id="correlation" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Correlation</h3>
<p>To numerically summarize relationships between variables, we typically compute correlation coefficients. The correlation coefficient is a quantification of the direction and strength of the relationship. (It is important to note that the correlation coefficient is only an appropriate summarization of the relationship if the functional form of the relationship is linear.)</p>
<p>To compute the correlation coefficient, we use the <code>correlate()</code> function from the <strong>corrr</strong> package. We can use the dplyr-type syntax to select the variables we want correlations between, and then pipe that into the <code>correlate()</code> function. Typically the response (or outcome) variable is the first variable provided in the <code>select()</code> function, followed by the predictor.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># Load corrr package</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">library</span>(corrr)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># Compute correlation between income and education level</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">city <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(income, education) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">correlate</span>()</a></code></pre></div>
<pre><code># A tibble: 2 x 3
  rowname   income education
  &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;
1 income    NA         0.795
2 education  0.795    NA    </code></pre>
<p>When reporting the correlation coefficient is is conventional to use a lower-case <span class="math inline">\(r\)</span> and report the value to two decimal places. Subscripts are also generally used to indicate the variables. For example,</p>
<p><span class="math display">\[
r_{\mathrm{education,~income}} = 0.79
\]</span></p>
<p>Combining the information culled from the scatterplot with that of the correlation analysis, we could summarize the relationship between education level and income as,</p>
<blockquote>
<p>There is a strong, positive, linear relationship between education level and income (<span class="math inline">\(r = .79\)</span>). This suggests that city employees with lower education levels tend to have lower incomes, on average, than employees with higher education levels.</p>
</blockquote>
</div>
</div>
<div id="statistical-model" class="section level2">
<h2><span class="header-section-number">1.4</span> Statistical Model</h2>
<p>The analytic goal is to now describe the relationship using a statistical model. Since the structure of the relationship between education level and income seems reasonably linear, we will use a <em>linear model</em> to describe the data. We can express this model mathematically as,</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1(X_i) + \epsilon_i.
\]</span></p>
<p>In this equation,</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the outcome/response value; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
<li><span class="math inline">\(\beta_0\)</span> is the intercept of the line that best fits the data; it does not vary across individuals.</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope of the line that best fits the data; it does not vary across individuals.</li>
<li><span class="math inline">\(X_i\)</span> is the predictor value; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
<li><span class="math inline">\(\epsilon_i\)</span> is the error term; it has an <span class="math inline">\(i\)</span> subscript because it can vary across cases/individuals.</li>
</ul>
<p>The regression model can be seperated into two components: a <em>systematic</em> (or fixed) component and a <em>random</em> (or stochastic) component.</p>
<p><span class="math display">\[
Y_i = \underbrace{\beta_0 + \beta_1(X_i)}_{\substack{\text{Systematic} \\ \text{(Fixed)}}} + \underbrace{\epsilon_i}_{\substack{\text{Random} \\ \text{(Stochastic)}}} 
\]</span></p>
<div id="fitted-regression-equation" class="section level3">
<h3><span class="header-section-number">1.4.1</span> Fitted Regression Equation</h3>
<p>The systematic (fixed) part of the equation gives the predicted <span class="math inline">\(Y\)</span> given a particular <span class="math inline">\(X\)</span>-value. The notation for the predicted <span class="math inline">\(Y\)</span> is <span class="math inline">\(\hat{Y}\)</span>. We express this mathematically as,</p>
<p><span class="math display">\[
\hat{Y}_i = \beta_0 + \beta_1(X_i).
\]</span></p>
<p>This is sometimes referred to as the <em>fitted regression equation</em> or the <em>fitted equation</em>. The terms <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are referred to as the regression parameters. One of the primary goals of a regression analysis is to estimate the values of the regression parameters (i.e., the intercept and slope terms). (Note that the fitted equation does not include any error terms.)</p>
</div>
<div id="errors" class="section level3">
<h3><span class="header-section-number">1.4.2</span> Errors</h3>
<p>Now we can re-write the statistical model, substituting <span class="math inline">\(\hat{Y}_i\)</span> in for the fitted part of the model.</p>
<p><span class="math display">\[
\begin{split}
Y_i &amp;= \beta_0 + \beta_1(X_i) + \epsilon_i \\
Y_i &amp;= \hat{Y}_i + \epsilon_i 
\end{split}
\]</span></p>
<p>This equation implies that each observed <span class="math inline">\(Y\)</span>-value is the sum of the predicted value of the <span class="math inline">\(Y\)</span> (which is based on the <span class="math inline">\(X\)</span>-value) and some error term. Re-arranging the terms, we can mathematically express the error term as,</p>
<p><span class="math display">\[
\epsilon_i = Y_i - \hat{Y}_i
\]</span></p>
<p>To compute an observation’s error, we compute the difference between the observation’s observed value (<span class="math inline">\(Y_i\)</span>) and its predicted value (<span class="math inline">\(\hat{Y}_i\)</span>) based on the fitted equation. When the observed value of <span class="math inline">\(Y\)</span> is larger than the predicted value of <span class="math inline">\(Y\)</span> the error term will be positive (underprediction). If the observed value of <span class="math inline">\(Y_i\)</span> is smaller than the predicted value of <span class="math inline">\(Y_i\)</span> the error term will be negative (overprediction).</p>
</div>
</div>
<div id="details-about-the-regression-model" class="section level2">
<h2><span class="header-section-number">1.5</span> Details about the Regression Model</h2>
<p>One question you may have is, why is there an error term in the statistical model? We use a single line to describe the relationship between education and income. This line is the same for all of the observations in the sample. For example, look at the figure below which shows the relationship between education and income, but this time also includes the regression line.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-9"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-9-1.png" alt="Scatterplot displaying the relationship between employee education levels and incomes. The OLS fitted regression line is also displayed." width="50%" />
<p class="caption">
Figure 1.4: Scatterplot displaying the relationship between employee education levels and incomes. The OLS fitted regression line is also displayed.
</p>
</div>
<p>Consider all the employees that have an education level of 10 years. For all three of them we would predict an income of approximately $37,800. This is denoted by the blue point on the line. The error term allows for discrepancy between the predicted <span class="math inline">\(Y\)</span> and the observed <span class="math inline">\(Y\)</span>, which allows us to recover our observed value of the response variable from the model.</p>
<p>Graphically, the residual is represented by the vertical distance between the line and a given point on the scatterplot. Some of those points are above the line (they have a positive residual) and some are below the line (they have a negative residual). Also note that for some observations the error term is smaller than for others.</p>
<div id="notation" class="section level3">
<h3><span class="header-section-number">1.5.1</span> Notation</h3>
<p>The regression model and the fitted regression equation describe the linear relationship in the <em>population</em>. Greek letters indicate a <em>parameter</em> (a summary of the population). That is why we use the Greek letters <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\epsilon\)</span> when we notate the regression model.</p>
<p>In most statistical analyses, you will use a <em>sample</em> of data (not the entire population). When we summarize a sample, it is referred to as a <em>statistic</em>, and we use either Roman letters or a Greek letter with a hat. This indicates that the summary measure is an estimate of the parameter. For example, the values produces for the intercept and slope from a regression analysis are estimates. Since they are estimates, we use the hat-notation on the greek letters.</p>
<p><span class="math display">\[
\hat{Y}_i = \hat{\beta}_0 + \hat{\beta}_1(X_i)
\]</span></p>
<p>The parameter estimates are also referred to as regression coefficients. Synonymously, a hat means estimated/predicted value. Some people use Roman letters when referring to sample estimates.</p>
<p><span class="math display">\[
\hat{Y}_i = B_0 + B_1(X_i)
\]</span></p>
<p>Similarly, in the population the error terms are expressed as the Greek letter epsilon (<span class="math inline">\(\epsilon_i\)</span>), while in the sample we use the Roman letter e (<span class="math inline">\(e_i\)</span>). The sample errors are also referred to as <em>residuals</em>.</p>
</div>
</div>
<div id="estimating-the-regression-coefficients-using-r" class="section level2">
<h2><span class="header-section-number">1.6</span> Estimating the Regression Coefficients Using R</h2>
<p>To fit the regression model to data using R, we will use the <code>lm()</code> function. The syntax for this function looks like this:</p>
<blockquote>
<p><code>lm(</code><strong>outcome</strong> ~ <code>1 +</code> <strong>predictor</strong>, <code>data =</code> <strong>dataframe</strong><code>)</code></p>
</blockquote>
<p>where <strong>outcome</strong> is the name of the outcome/response variable, <strong>predictor</strong> is the name of the predictor variable, and <strong>dataframe</strong> is the name of the data frame. (The one on the right side of the tilde tells R to include the intercept in its computation.) When we fit a regression model in R, we will also assign the output to a new object in R. Below, we fit the model using education level to predict income.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">lm<span class="fl">.1</span> =<span class="st"> </span><span class="kw">lm</span>(income <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>education, <span class="dt">data =</span> city)</a></code></pre></div>
<p>Here the output is assigned to an object called <code>lm.1</code>. We can print the regression parameter estimates by typing the <code>lm()</code> object name and hitting enter.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">lm<span class="fl">.1</span></a></code></pre></div>
<pre><code>
Call:
lm(formula = income ~ 1 + education, data = city)

Coefficients:
(Intercept)    education  
      11.32         2.65  </code></pre>
<p>Here the parameter estimates (or regression coefficients) are:</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0 = 11.32\)</span></li>
<li><span class="math inline">\(\hat{\beta}_1 = 2.65\)</span></li>
</ul>
<p>The fitted regression equation is</p>
<p><span class="math display">\[
\hat{\mathrm{Income}}_i = 11.32 + 2.65(\mathrm{Education~Level}_i).
\]</span></p>
<div id="intercept-interpretation" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Intercept Interpretation</h3>
<p>The estimate for the intercept was 11.32. Graphically, this value indicates the <span class="math inline">\(y\)</span>-value where the line passes through the <span class="math inline">\(y\)</span>-axis (i.e., <span class="math inline">\(y\)</span>-intercept). As such, it gives the predicted value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X = 0\)</span>. Algebraically we get the same thing if we substitute 0 in for <span class="math inline">\(X_i\)</span> in the estimated regression equation.</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_i &amp;= \hat{\beta}_0 + \hat{\beta}_1(0) \\
\hat{Y}_i &amp;= \hat{\beta}_0 
\end{split}
\]</span></p>
<p>In our example,</p>
<p><span class="math display">\[
\begin{split}
\hat{Y}_i &amp;= 11.32 + 2.65(0) \\
\hat{Y}_i &amp;= 11.32 
\end{split}
\]</span></p>
<p>To interpret this value, we use that same idea. Namely</p>
<blockquote>
<p>The predicted income for all employees that have an education level of 0 years is 11.32 thousand dollars.</p>
</blockquote>
</div>
<div id="slope-interpretation" class="section level3">
<h3><span class="header-section-number">1.6.2</span> Slope Interpretation</h3>
<p>Recall from algebra that the slope of a line describes the change in <span class="math inline">\(Y\)</span> versus the change in <span class="math inline">\(X\)</span>. In regression, the slope describes the <em>predicted</em> change in <span class="math inline">\(\hat{Y}\)</span> for a one-unit difference in <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[
\hat{\beta}_1 = \frac{\Delta\hat{Y}}{\Delta X} = \frac{2.65}{1}
\]</span></p>
<p>In our example,</p>
<blockquote>
<p>Each one-year difference in education level is associated with a 2.65 thousand dollar predicted difference in income.</p>
</blockquote>
<p>To better understand this, consider three city employees. The first employee has an education level of 10 years. The second has an education level of 11 years, and the third has an education level of 12 years. Now let’s compute each employee’s predicted income.</p>
<p><span class="math display">\[
\begin{split}
\mathbf{Employee~1:~}\hat{\mathrm{Income}} &amp;= 11.32 + 2.65(10) \\
&amp;= 37.82
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\mathbf{Employee~2:~}\hat{\mathrm{Income}} &amp;= 11.32 + 2.65(11) \\
&amp;= 40.47
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\mathbf{Employee~3:~}\hat{\mathrm{Income}} &amp;= 11.32 + 2.65(12) \\
&amp;= 43.12
\end{split}
\]</span></p>
<p>Each of the employee’s education levels differ by one year (10 to 11 to 12). The difference in predicted incomes for these employees differs by 2.65 thousand dollars.</p>
</div>
</div>
<div id="using-the-regression-equation" class="section level2">
<h2><span class="header-section-number">1.7</span> Using the Regression Equation</h2>
<p>Consider the first case in the data frame.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">city <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">row_number</span>() <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a></code></pre></div>
<pre><code># A tibble: 1 x 6
  education income seniority gender  male party   
      &lt;int&gt;  &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;   
1         8   37.4         7 male       1 Democrat</code></pre>
<p>This employee has an education level of eight years (<span class="math inline">\(X_{1}=8\)</span>). His income is 37.45 thousand dollars (<span class="math inline">\(Y_{1}=37.45\)</span>). Using the fitted equation, we can compute that employee’s predicted income as,</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="fl">11.32</span> <span class="op">+</span><span class="st"> </span><span class="fl">2.65</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span></a></code></pre></div>
<pre><code>[1] 32.52</code></pre>
<p><span class="math inline">\(\hat{Y}_{12} = 32.52\)</span>.</p>
<p>We can also compute that employee’s residual.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="fl">37.45</span> <span class="op">-</span><span class="st"> </span><span class="fl">32.52</span></a></code></pre></div>
<pre><code>[1] 4.93</code></pre>
<p><span class="math inline">\(e_{1} = 4.93\)</span>.</p>
<p>The positive residual suggests that this employee earns 4.93 thousand dollars more than would be expected for a city employee with eight years of formal education. We can also represent these values graphically.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-15-1.png" alt="Plot displaying the OLS fitted regression line (blue) between employee education levels and incomes. The first employee's observed data (black dot) is plotted, and a visual representation of the employee's residual (red line) is also displayed." width="50%" />
<p class="caption">
Figure 1.5: Plot displaying the OLS fitted regression line (blue) between employee education levels and incomes. The first employee’s observed data (black dot) is plotted, and a visual representation of the employee’s residual (red line) is also displayed.
</p>
</div>
</div>
<div id="conditional-averages" class="section level2">
<h2><span class="header-section-number">1.8</span> Conditional Averages</h2>
<p>To this point, we have used the fitted regression equation to predict for individual employees. Another way to think about the predicted value is it describes the mean value of <span class="math inline">\(Y\)</span> for <em>all</em> cases with a particular <span class="math inline">\(X\)</span> value. For example, using the values from the previous example we found that <span class="math inline">\(\hat{Y}_{1} = 37.45\)</span> when <span class="math inline">\(X_{1}=8\)</span>. Using means, we could interpret this as,</p>
<blockquote>
<p>The estimated average income for city employees having 8 years of education is 37.45 thousand dollars.</p>
</blockquote>
<p>A statistician may refer to the predicted value of <span class="math inline">\(Y\)</span> as a conditional mean (it is conditioned on a particular value of <span class="math inline">\(X\)</span>). To help better understand the idea of conditional means, consider the following plot:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-16"></span>
<img src="images/conditional-means.png" alt="Plot displaying conditional distribution of $Y$ at several $X$ values. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for each conditional distribution." width="50%" />
<p class="caption">
Figure 1.6: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at several <span class="math inline">\(X\)</span> values. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for each conditional distribution.
</p>
</div>
<p>Examining this plot, we see at each value of <span class="math inline">\(X\)</span> there is a distribution of <span class="math inline">\(Y\)</span>. For example, there would be a distribution of incomes for the employees with an education level of 8 years (in the population). There would be another distribution of incomes for the employees with an education level of 9 years (in the population). And so on.</p>
<p>The regression equation describes the pattern of conditional means. As such, we can write the fitted equation using means rather than <span class="math inline">\(\hat{Y}\)</span>,</p>
<p><span class="math display">\[
\mu_{Y|X_i} = \beta_0 + \beta_1(X_i)
\]</span></p>
<p>The first part is read as, “the mean of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X_i\)</span>”, or “the mean of <span class="math inline">\(Y\)</span> conditioned on <span class="math inline">\(X_i\)</span>”. Sometimes the mean of a population is denoted as <span class="math inline">\(E(Y)\)</span>, or the expected value of <span class="math inline">\(Y\)</span>. Then you might see the regression equation written as,</p>
<p><span class="math display">\[
E(Y|X_i) = \beta_0 + \beta_1(X_i)
\]</span></p>
<p>When we assume a linear functional form for the model, we are saying that the mean value of <span class="math inline">\(Y\)</span> differs by a constant amount for each one-unit difference in <span class="math inline">\(X\)</span>. In other words, the difference between the mean income for those employees who have ten years of education and those that have 11 years of education <em>is the same as</em> the difference between the mean income for those employees who have 17 years of education and those that have 18 years of education.</p>
<p>Using this idea, the statistical model can be written as,</p>
<p><span class="math display">\[
\begin{split}
Y_i &amp;= \beta_0 + \beta_1(X_i) + \epsilon_i \\
Y_i &amp;= \mu_{Y|X_i} + \epsilon_i
\end{split}
\]</span></p>
<p>That is, each observations observed value (<span class="math inline">\(Y_i\)</span>) is a function of the mean <span class="math inline">\(Y\)</span>-value (given <span class="math inline">\(X_i\)</span>) and error. The error represents how far the observed value is from that mean:</p>
<p><span class="math display">\[
\epsilon_i  = Y_i - \mu_{Y|X_i}
\]</span></p>
<p>In statistical parlance, this is referred to as a <em>mean deviation</em>.</p>
<div id="intercept-re-visited" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Intercept (Re-visited)</h3>
<p>Using the idea of conditional means, we can re-visit the interpretation of the intercept, which we had said was the predicted <span class="math inline">\(Y\)</span> for a person with an <span class="math inline">\(X\)</span>-value of zero. Now we can say that the intercept is the predicted mean income for all employees with zero years of formal education.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-17"></span>
<img src="images/conditional-means-intercept.png" alt="Plot displaying conditional distribution of $Y$ at $X=0$. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for this conditional distribution---which corresponfds to the intercept value of the regression line." width="50%" />
<p class="caption">
Figure 1.7: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at <span class="math inline">\(X=0\)</span>. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for this conditional distribution—which corresponfds to the intercept value of the regression line.
</p>
</div>
</div>
</div>
<div id="slope-re-visited" class="section level2">
<h2><span class="header-section-number">1.9</span> Slope (Re-visited)</h2>
<p>Using the idea of conditional means, we can also re-visit the interpretation of the slope, which we had said was the predicted difference in <span class="math inline">\(Y\)</span> for employees with a one-year difference in education. Now we can say that the slope is the predicted difference in mean incomes between employees with education levels that differ by one year.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-18"></span>
<img src="images/conditional-means-slope.png" alt="Plot displaying conditional distribution of $Y$ at $X=0$ and $X=1$. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of $Y$ for these conditional distributions---the relative change which corresponfds to the slope value of the regression line." width="50%" />
<p class="caption">
Figure 1.8: Plot displaying conditional distribution of <span class="math inline">\(Y\)</span> at <span class="math inline">\(X=0\)</span> and <span class="math inline">\(X=1\)</span>. The OLS fitted regression line (dotted) is also shown. The red points show the mean value of <span class="math inline">\(Y\)</span> for these conditional distributions—the relative change which corresponfds to the slope value of the regression line.
</p>
</div>
<blockquote>
<p>In general, when interpreting the slope and intercept, you should use the conditional mean interpretations.</p>
</blockquote>
</div>
<div id="revisiting-the-statistical-model" class="section level2">
<h2><span class="header-section-number">1.10</span> Revisiting the Statistical Model</h2>
<p>Recall that the statistical model underlying the simple regression is,</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1(X_i) + \epsilon_i
\]</span></p>
<p>and that we can estimate the coefficients (<span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span>) and the errors (<span class="math inline">\(e_i\)</span>) using the data (<span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span>). This model can be used to express each of the 32 observations.</p>
<p><span class="math display">\[
\begin{split}
37.4 &amp;= 11.32 &amp;+ 2.65(8) &amp;+ 4.93 \\
26.4 &amp;= 11.32 &amp;+ 2.65(8) &amp;- 6.09 \\
47.0 &amp;= 11.32 &amp;+ 2.65(10) &amp;+ 9.21 \\
34.2 &amp;= 11.32 &amp;+ 2.65(10) &amp;- 3.64 \\
\vdots &amp; &amp; \vdots &amp; \vdots \\
56.3 &amp;= 11.32 &amp;+ 2.65(22) &amp;- 13.30 \\
70.0 &amp;= 11.32 &amp;+ 2.65(22) &amp;+ 0.42 \\
79.2 &amp;= 11.32 &amp;+ 2.65(24) &amp;+ 4.31 \\
\end{split}
\]</span></p>
<p>Looking at these equations, it can be seen that the coefficients (<span class="math inline">\(\hat\beta_0\)</span> and <span class="math inline">\(\hat\beta_1\)</span>) are the same in all 32 equations. Because of this we say that the regression coefficients are <em>fixed</em>. The other components, <span class="math inline">\(Y_i\)</span>, <span class="math inline">\(X_i\)</span>, and <span class="math inline">\(e_i\)</span> vary (can be different) across the 32 equations. Because of this we say that the data (<span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span>) and the errors (<span class="math inline">\(e_i\)</span>) are <em>random</em>. In writing the model, all the random components get an <span class="math inline">\(i\)</span>-subscript; fixed components do not.</p>
</div>
<div id="one-more-example" class="section level2">
<h2><span class="header-section-number">1.11</span> One More Example</h2>
<p>In this example, we will use the <em>ed-school-2018.csv</em> data (see <a href="data-codebook.html#ed-schools">data codebook</a> for more information) to examine whether doctoral acceptance rate (<code>doc_accept</code>) is related to expert ratings of education schools (<code>expert_score</code>) for the 129 programs ranked in the <em>2018 Best Graduate Schools</em>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">ed_schools =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;~/Documents/github/epsy-8251/data/ed-schools-2018.csv&quot;</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">head</span>(ed_schools)</a></code></pre></div>
<pre><code># A tibble: 6 x 13
   rank school score  peer expert_score gre_verbal gre_quant doc_accept
  &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;        &lt;dbl&gt;      &lt;int&gt;     &lt;int&gt;      &lt;dbl&gt;
1     1 Harva…   100   4.4          4.6        163       159        4.5
2     2 Stanf…    99   4.6          4.8        162       160        6.1
3     3 Unive…    96   4.2          4.3        156       152       29.1
4     3 Unive…    96   4.1          4.5        163       157        5  
5     3 Unive…    96   4.3          4.5        155       153       26.1
6     6 Johns…    95   4.1          4.1        164       162       27.4
# ... with 5 more variables: phd_student_faculty_ratio &lt;dbl&gt;,
#   phd_granted_per_faculty &lt;chr&gt;, funded_research &lt;dbl&gt;,
#   funded_research_per_faculty &lt;dbl&gt;, enroll &lt;int&gt;</code></pre>
<p>To begin we examine the scatterplot of the relationship between the two variables. The plot below also shows the marginal distributions for the two variables. This plot was created with the <code>ggMarginal()</code> function from the <strong>ggExtra</strong> package. To learn more, see the <strong>ggExtra</strong> documentation at <a href="https://cran.r-project.org/web/packages/ggExtra/README.html" class="uri">https://cran.r-project.org/web/packages/ggExtra/README.html</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-20"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-20-1.png" alt="Scatterplot showing the relationship between doctoral acceptance rate and expert rating for 129 graduate programs of education. Plots of the marginal distributions for these distributions are also displayed." width="50%" />
<p class="caption">
Figure 1.9: Scatterplot showing the relationship between doctoral acceptance rate and expert rating for 129 graduate programs of education. Plots of the marginal distributions for these distributions are also displayed.
</p>
</div>
<p>We also compute summary measure of each distribution and the correlation between them.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># Summary measures of the predictor</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">ed_schools <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb24-4" data-line-number="4">    <span class="dt">M =</span> <span class="kw">mean</span>(doc_accept), </a>
<a class="sourceLine" id="cb24-5" data-line-number="5">    <span class="dt">SD =</span> <span class="kw">sd</span>(doc_accept)</a>
<a class="sourceLine" id="cb24-6" data-line-number="6">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1  41.4  21.2</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Summary measures of the outcome</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">ed_schools <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">    <span class="dt">M =</span> <span class="kw">mean</span>(expert_score), </a>
<a class="sourceLine" id="cb26-5" data-line-number="5">    <span class="dt">SD =</span> <span class="kw">sd</span>(expert_score)</a>
<a class="sourceLine" id="cb26-6" data-line-number="6">    )</a></code></pre></div>
<pre><code># A tibble: 1 x 2
      M    SD
  &lt;dbl&gt; &lt;dbl&gt;
1  3.64 0.475</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co"># Correlation</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">ed_schools <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(expert_score, doc_accept) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="kw">correlate</span>()</a></code></pre></div>
<pre><code># A tibble: 2 x 3
  rowname      expert_score doc_accept
  &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
1 expert_score       NA         -0.501
2 doc_accept         -0.501     NA    </code></pre>
<p>The scatterplot suggests a moderate linear negative relationship between doctoral acceptance rate and expert rating of education graduate programs (<span class="math inline">\(r = -0.50\)</span>). This suggests that graduate programs that have higher expert ratings tend to have lower acceptance rates of doctoral students. The scatterplot also shows that one program (New Mexico State University) has an expert rating that is substantially lower than the other program’s ratings.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co"># Fit regression model</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">lm<span class="fl">.2</span> =<span class="st"> </span><span class="kw">lm</span>(expert_score <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>doc_accept, <span class="dt">data =</span> ed_schools)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co"># Obtain coefficients</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">lm<span class="fl">.2</span></a></code></pre></div>
<pre><code>
Call:
lm(formula = expert_score ~ 1 + doc_accept, data = ed_schools)

Coefficients:
(Intercept)   doc_accept  
     4.1020      -0.0112  </code></pre>
<p>The fitted equation is:</p>
<p><span class="math display">\[
\hat{\mathrm{Expert~Rating}_i} = 4.10 - 0.01(\mathrm{Doctoral~Acceptance~Rate}_i)
\]</span></p>
<p>Interpreting the coefficients,</p>
<ul>
<li>Education graduate programs that accept 0% of doctoral students have a predicted average expert rating of 4.10 (extrapolation).</li>
<li>Each one-percent difference in acceptance rate is associated with a <span class="math inline">\(-0.01\)</span>-point difference in ratings, on average.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="literature.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"collapse": "section",
"toolbar": null,
"position": "fixed",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
