<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Unit 3: Nonlinearity: Log-Transforming the Outcome | EPsy 8252 Notes</title>
  <meta name="description" content="These are the notes for EPsy 8252.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Unit 3: Nonlinearity: Log-Transforming the Outcome | EPsy 8252 Notes />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the notes for EPsy 8252." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Unit 3: Nonlinearity: Log-Transforming the Outcome | EPsy 8252 Notes />
  
  <meta name="twitter:description" content="These are the notes for EPsy 8252." />
  

<meta name="author" content="Andrew Zieffler">


<meta name="date" content="2018-12-31">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="nonlinearity-log-transforming-the-predictor.html">
<link rel="next" href="log-transformations-some-final-thoughts.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPsy 8252 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the Course</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-content"><i class="fa fa-check"></i>Course Content</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#books-and-other-reading-materials"><i class="fa fa-check"></i>Books and Other Reading Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>1</b> R Markdown</a><ul>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#preparation"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#notes"><i class="fa fa-check"></i>Notes</a></li>
<li class="chapter" data-level="" data-path="rmarkdown.html"><a href="rmarkdown.html#other-resources"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html"><i class="fa fa-check"></i><b>2</b> Nonlinearity: Log-Transforming the Predictor</a><ul>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#preparation-1"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="2.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#dataset-and-research-question"><i class="fa fa-check"></i><b>2.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="2.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#log-transformation-of-a-variable"><i class="fa fa-check"></i><b>2.2</b> Log-Transformation of a Variable</a><ul>
<li class="chapter" data-level="2.2.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#quick-refresher-on-logarithms"><i class="fa fa-check"></i><b>2.2.1</b> Quick Refresher on Logarithms</a></li>
<li class="chapter" data-level="2.2.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#log-transforming-variables"><i class="fa fa-check"></i><b>2.2.2</b> Log-Transforming Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>2.3</b> Fitting the Regression Model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#examine-the-assumption-of-linearity"><i class="fa fa-check"></i><b>2.3.1</b> Examine the Assumption of Linearity</a></li>
<li class="chapter" data-level="2.3.2" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#interpret-the-regression-results"><i class="fa fa-check"></i><b>2.3.2</b> Interpret the Regression Results</a></li>
<li class="chapter" data-level="2.3.3" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#better-interpretations-back-transforming"><i class="fa fa-check"></i><b>2.3.3</b> Better Interpretations: Back-transforming</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#alternative-method-of-fitting-the-model"><i class="fa fa-check"></i><b>2.4</b> Alternative Method of Fitting the Model</a></li>
<li class="chapter" data-level="2.5" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#plotting-the-fitted-model"><i class="fa fa-check"></i><b>2.5</b> Plotting the Fitted Model</a></li>
<li class="chapter" data-level="2.6" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#different-base-values-in-the-logarithm"><i class="fa fa-check"></i><b>2.6</b> Different Base Values in the Logarithm</a><ul>
<li class="chapter" data-level="2.6.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#comparing-the-output-from-the-two-bases"><i class="fa fa-check"></i><b>2.6.1</b> Comparing the Output from the Two Bases</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#base-e-logarithm-the-natural-logarithm"><i class="fa fa-check"></i><b>2.7</b> Base-<span class="math inline">\(e\)</span> Logarithm: The Natural Logarithm</a><ul>
<li class="chapter" data-level="2.7.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#using-the-natural-logarithm-in-a-regression-model"><i class="fa fa-check"></i><b>2.7.1</b> Using the Natural Logarithm in a Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#including-covariates"><i class="fa fa-check"></i><b>2.8</b> Including Covariates</a><ul>
<li class="chapter" data-level="2.8.1" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#plot-of-the-model-results"><i class="fa fa-check"></i><b>2.8.1</b> Plot of the Model Results</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#polynomial-effects-vs.log-transformations"><i class="fa fa-check"></i><b>2.9</b> Polynomial Effects vs. Log-Transformations</a></li>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-predictor.html"><a href="nonlinearity-log-transforming-the-predictor.html#other-resources-1"><i class="fa fa-check"></i>Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html"><i class="fa fa-check"></i><b>3</b> Nonlinearity: Log-Transforming the Outcome</a><ul>
<li class="chapter" data-level="" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#preparation-2"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="3.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#dataset-and-research-question-1"><i class="fa fa-check"></i><b>3.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="3.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#examine-relationship-between-age-and-budget"><i class="fa fa-check"></i><b>3.2</b> Examine Relationship between Age and Budget</a></li>
<li class="chapter" data-level="3.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#transform-the-outcome-using-the-natural-logarithm-base-e"><i class="fa fa-check"></i><b>3.3</b> Transform the Outcome Using the Natural Logarithm (Base-e)</a></li>
<li class="chapter" data-level="3.4" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#re-analyze-using-the-log-transformed-budget"><i class="fa fa-check"></i><b>3.4</b> Re-analyze using the Log-Transformed Budget</a></li>
<li class="chapter" data-level="3.5" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#interpreting-the-regression-output"><i class="fa fa-check"></i><b>3.5</b> Interpreting the Regression Output</a><ul>
<li class="chapter" data-level="3.5.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#back-transforming-a-more-useful-interpretation"><i class="fa fa-check"></i><b>3.5.1</b> Back-Transforming: A More Useful Interpretation</a></li>
<li class="chapter" data-level="3.5.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#substituting-in-values-for-age-to-interpret-effects"><i class="fa fa-check"></i><b>3.5.2</b> Substituting in Values for Age to Interpret Effects</a></li>
<li class="chapter" data-level="3.5.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#approximate-interpretation-of-the-slope"><i class="fa fa-check"></i><b>3.5.3</b> Approximate Interpretation of the Slope</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#plotting-the-fitted-model-1"><i class="fa fa-check"></i><b>3.6</b> Plotting the Fitted Model</a></li>
<li class="chapter" data-level="3.7" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#relationship-between-mpaa-rating-and-budget"><i class="fa fa-check"></i><b>3.7</b> Relationship between MPAA Rating and Budget</a><ul>
<li class="chapter" data-level="3.7.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#regression-model"><i class="fa fa-check"></i><b>3.7.1</b> Regression Model</a></li>
<li class="chapter" data-level="3.7.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#mathematical-explanation-1"><i class="fa fa-check"></i><b>3.7.2</b> Mathematical Explanation</a></li>
<li class="chapter" data-level="3.7.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#approximate-interpretations"><i class="fa fa-check"></i><b>3.7.3</b> Approximate Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#multiple-regression-main-effects-model"><i class="fa fa-check"></i><b>3.8</b> Multiple Regression: Main Effects Model</a><ul>
<li class="chapter" data-level="3.8.1" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#nested-f-test"><i class="fa fa-check"></i><b>3.8.1</b> Nested F-Test</a></li>
<li class="chapter" data-level="3.8.2" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#coefficient-level-interpretation"><i class="fa fa-check"></i><b>3.8.2</b> Coefficient-Level Interpretation</a></li>
<li class="chapter" data-level="3.8.3" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#plot-of-the-fitted-model"><i class="fa fa-check"></i><b>3.8.3</b> Plot of the Fitted Model</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="nonlinearity-log-transforming-the-outcome.html"><a href="nonlinearity-log-transforming-the-outcome.html#multiple-regression-interaction-model"><i class="fa fa-check"></i><b>3.9</b> Multiple Regression: Interaction Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html"><i class="fa fa-check"></i>Log Transformations: Some Final Thoughts</a><ul>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#power-transformations"><i class="fa fa-check"></i>Power Transformations</a><ul>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#ladder-of-transformations"><i class="fa fa-check"></i>Ladder of Transformations</a></li>
<li class="chapter" data-level="" data-path="log-transformations-some-final-thoughts.html"><a href="log-transformations-some-final-thoughts.html#rule-of-the-bulge"><i class="fa fa-check"></i>Rule of the Bulge</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>4</b> Probability Distributions</a><ul>
<li class="chapter" data-level="" data-path="probability-distributions.html"><a href="probability-distributions.html#preparation-3"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="4.1" data-path="probability-distributions.html"><a href="probability-distributions.html#dataset-and-research-question-2"><i class="fa fa-check"></i><b>4.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="4.2" data-path="probability-distributions.html"><a href="probability-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>4.2</b> Normal Distribution</a><ul>
<li class="chapter" data-level="4.2.1" data-path="probability-distributions.html"><a href="probability-distributions.html#other-useful-r-functions-for-working-with-probability-distributions"><i class="fa fa-check"></i><b>4.2.1</b> Other Useful R Functions for Working with Probability Distributions</a></li>
<li class="chapter" data-level="4.2.2" data-path="probability-distributions.html"><a href="probability-distributions.html#finding-cumulative-probability"><i class="fa fa-check"></i><b>4.2.2</b> Finding Cumulative Probability</a></li>
<li class="chapter" data-level="4.2.3" data-path="probability-distributions.html"><a href="probability-distributions.html#cumulative-density-and-p-value"><i class="fa fa-check"></i><b>4.2.3</b> Cumulative Density and <span class="math inline">\(p\)</span>-Value</a></li>
<li class="chapter" data-level="4.2.4" data-path="probability-distributions.html"><a href="probability-distributions.html#finding-quantiles"><i class="fa fa-check"></i><b>4.2.4</b> Finding Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probability-distributions.html"><a href="probability-distributions.html#students-t-distribution"><i class="fa fa-check"></i><b>4.3</b> Student’s <span class="math inline">\(t\)</span>-Distribution</a><ul>
<li class="chapter" data-level="4.3.1" data-path="probability-distributions.html"><a href="probability-distributions.html#comparing-probability-densities"><i class="fa fa-check"></i><b>4.3.1</b> Comparing Probability Densities</a></li>
<li class="chapter" data-level="4.3.2" data-path="probability-distributions.html"><a href="probability-distributions.html#comparing-cumulative-densities"><i class="fa fa-check"></i><b>4.3.2</b> Comparing Cumulative Densities</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="probability-distributions.html"><a href="probability-distributions.html#using-the-t-distribution-in-regression"><i class="fa fa-check"></i><b>4.4</b> Using the <span class="math inline">\(t\)</span>-Distribution in Regression</a></li>
<li class="chapter" data-level="4.5" data-path="probability-distributions.html"><a href="probability-distributions.html#model-level-inference-the-f-distribution"><i class="fa fa-check"></i><b>4.5</b> Model-Level Inference: The <span class="math inline">\(F\)</span>-Distribution</a><ul>
<li class="chapter" data-level="4.5.1" data-path="probability-distributions.html"><a href="probability-distributions.html#testing-the-model-level-null-hypothesis"><i class="fa fa-check"></i><b>4.5.1</b> Testing the Model-Level Null Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="probability-distributions.html"><a href="probability-distributions.html#mean-squares-are-variance-estimates"><i class="fa fa-check"></i><b>4.6</b> Mean Squares are Variance Estimates</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>5</b> Maximum Likelihood Estimation</a><ul>
<li class="chapter" data-level="" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#preparation-4"><i class="fa fa-check"></i>Preparation</a></li>
<li class="chapter" data-level="5.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#dataset-and-research-question-3"><i class="fa fa-check"></i><b>5.1</b> Dataset and Research Question</a></li>
<li class="chapter" data-level="5.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#joint-probability-density"><i class="fa fa-check"></i><b>5.2</b> Joint Probability Density</a></li>
<li class="chapter" data-level="5.3" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#likelihood"><i class="fa fa-check"></i><b>5.3</b> Likelihood</a></li>
<li class="chapter" data-level="5.4" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood"><i class="fa fa-check"></i><b>5.4</b> Maximum Likelihood</a><ul>
<li class="chapter" data-level="5.4.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#method-1-grid-search"><i class="fa fa-check"></i><b>5.4.1</b> Method 1: Grid Search</a></li>
<li class="chapter" data-level="5.4.2" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#log-likelihood"><i class="fa fa-check"></i><b>5.4.2</b> Log-Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#maximum-likelihood-estimation-for-regression"><i class="fa fa-check"></i><b>5.5</b> Maximum Likelihood Estimation for Regression</a><ul>
<li class="chapter" data-level="5.5.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#large-search-spaces"><i class="fa fa-check"></i><b>5.5.1</b> Large Search Spaces</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#ml-estimation-in-regression-using-r"><i class="fa fa-check"></i><b>5.6</b> ML Estimation in Regression Using R</a><ul>
<li class="chapter" data-level="5.6.1" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#using-r-to-directly-compute-the-likelihood-and-log-likelihood"><i class="fa fa-check"></i><b>5.6.1</b> Using R to Directly Compute the Likelihood and Log-Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="maximum-likelihood-estimation.html"><a href="maximum-likelihood-estimation.html#way-way-way-too-much-mathematics-way-too-much-math"><i class="fa fa-check"></i><b>5.7</b> Way, Way, Way too Much Mathematics {way-too-much-math}</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html"><i class="fa fa-check"></i>Data Codebooks</a><ul>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#ed-schools"><i class="fa fa-check"></i>ed-schools.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#mn-schools"><i class="fa fa-check"></i>mn-schools.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#movies"><i class="fa fa-check"></i>movies.csv</a></li>
<li class="chapter" data-level="" data-path="data-codebook.html"><a href="data-codebook.html#riverview"><i class="fa fa-check"></i>riverview.csv</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EPsy 8252 Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nonlinearity-log-transforming-the-outcome" class="section level1">
<h1><span class="header-section-number">Unit 3:</span> Nonlinearity: Log-Transforming the Outcome</h1>
<p>In this set of notes, you will learn about log-transforming the outcome variable in a regression model to account for nonlinearity and heterogeneity of variance.</p>
<hr />
<div id="preparation-2" class="section level3 unnumbered">
<h3>Preparation</h3>
<p>Before class you will need to read the following:</p>
<ul>
<li>Osborne, Jason (2002). <a href="https://pareonline.net/getvn.asp?v=8&amp;n=6">Notes on the use of data transformations</a>. <em>Practical Assessment, Research &amp; Evaluation, 8</em>(6).</li>
</ul>
<p><br /></p>
<hr />
</div>
<div id="dataset-and-research-question-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Dataset and Research Question</h2>
<p>The data we will use in this set of notes, <em>movies.csv</em> (see the <a href="data-codebook.html#movies">data codebook</a> here), includes attributes for <span class="math inline">\(n=1,806\)</span> movies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load libraries</span>
<span class="kw">library</span>(broom)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(readr)
<span class="kw">library</span>(sm)
<span class="kw">library</span>(tidyr)

<span class="co"># Import data</span>
movies =<span class="st"> </span><span class="kw">read_csv</span>(<span class="dt">file =</span> <span class="st">&quot;~/Documents/github/epsy-8252/data/movies.csv&quot;</span>)
<span class="kw">head</span>(movies)</code></pre></div>
<pre><code># A tibble: 6 x 4
  title                      budget   age mpaa 
  &lt;chr&gt;                       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1 &#39;Til There Was You           23      21 PG-13
2 10 Things I Hate About You   16      19 PG-13
3 100 Mile Rule                 1.1    16 R    
4 13 Going On 30               37      14 PG-13
5 13th Warrior, The            85      19 R    
6 15 Minutes                   42      17 R    </code></pre>
<p>Using these data, we will examine the relationship between age of a movie and budget.</p>
</div>
<div id="examine-relationship-between-age-and-budget" class="section level2">
<h2><span class="header-section-number">3.2</span> Examine Relationship between Age and Budget</h2>
<p>To being the analysis, we will examine the scatterplot between age and budget of our sample data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> movies, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> budget)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Movie age&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Movie Budget (in millions of dollars)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-38"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-38-1.png" alt="Scatterplot between age and budget. The loess smoother is also displayed." width="50%" />
<p class="caption">
Figure 3.1: Scatterplot between age and budget. The loess smoother is also displayed.
</p>
</div>
<p>The scatterplot suggests two potential problems with fitting a linear model to the data:</p>
<ul>
<li>The relationship is slightly curvilinear.</li>
<li>The variation in budget for more recnt movies is much greater than the variation in budget for older movies (heteroskedasticity).</li>
</ul>
<p>We can see this much more clearly in the scatterplot of residuals versus fitted values from a fitted linear model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit model</span>
lm.<span class="dv">1</span> =<span class="st"> </span><span class="kw">lm</span>(budget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> movies)

<span class="co"># Obtain residuals and fitted values</span>
out_<span class="dv">1</span> =<span class="st"> </span><span class="kw">augment</span>(lm.<span class="dv">1</span>)

<span class="co"># Density plot of the residuals</span>
<span class="kw">sm.density</span>(out_<span class="dv">1</span><span class="op">$</span>.std.resid, <span class="dt">model =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Standardized residuals&quot;</span>)

<span class="co"># Residuals versus fitted values</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> out_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .std.resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted values&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Standardized residuals&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-39"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-39-1.png" alt="Residual plots from regressing budget on age." width="40%" /><img src="epsy-8252-notes_files/figure-html/unnamed-chunk-39-2.png" alt="Residual plots from regressing budget on age." width="40%" />
<p class="caption">
Figure 3.2: Residual plots from regressing budget on age.
</p>
</div>
<p>These plots suggest violations of the normality assumption (the marginal distribution of the residuals is right-skewed) and of the assumption of homoskedasticity. Because of the large sample size, violation the linearity assumption is more difficult to see in this plot.</p>
</div>
<div id="transform-the-outcome-using-the-natural-logarithm-base-e" class="section level2">
<h2><span class="header-section-number">3.3</span> Transform the Outcome Using the Natural Logarithm (Base-e)</h2>
<p>To alleviate problems of non-normality when the conditional distributions are right-skewed (or have high-end outliers) OR to alleviate heteroskadisticy, we can mathematically transform the outcome using a logarithm. Any base can be used for the logarithm, but we will transform the outcome using the natural logarithm because of the interpretive value.</p>
<p>First, we will create the log-transformed variable as a new column in the data, and then we will use the log-transformed budget (rather than raw budget) in any analyses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create log-transformed budget</span>
movies =<span class="st"> </span>movies <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">Lbudget =</span> <span class="kw">log</span>(budget)
    )

<span class="co"># Examine data</span>
<span class="kw">head</span>(movies)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["title"],"name":[1],"type":["chr"],"align":["left"]},{"label":["budget"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mpaa"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Lbudget"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"'Til There Was You","2":"23.0","3":"21","4":"PG-13","5":"3.13549"},{"1":"10 Things I Hate About You","2":"16.0","3":"19","4":"PG-13","5":"2.77259"},{"1":"100 Mile Rule","2":"1.1","3":"16","4":"R","5":"0.09531"},{"1":"13 Going On 30","2":"37.0","3":"14","4":"PG-13","5":"3.61092"},{"1":"13th Warrior, The","2":"85.0","3":"19","4":"R","5":"4.44265"},{"1":"15 Minutes","2":"42.0","3":"17","4":"R","5":"3.73767"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Recall that the logarithm is the inverse function of an exponent. As an example, consider the budget and log-transformed budget for <em>’Til There Was You</em>.</p>
<p><span class="math display">\[
\begin{split}
\ln(\textrm{Budget}) &amp;= 3.135 \\
\ln(23.0) &amp;= 3.135 \\
\end{split}
\]</span></p>
<p>Or,</p>
<p><span class="math display">\[
e^{3.135} = 23.0
\]</span></p>
<p>Remember, the logarithm answers the mathematical question:</p>
<blockquote>
<p><span class="math inline">\(e\)</span> to what power is equal to 23.0?</p>
</blockquote>
</div>
<div id="re-analyze-using-the-log-transformed-budget" class="section level2">
<h2><span class="header-section-number">3.4</span> Re-analyze using the Log-Transformed Budget</h2>
<p>Now we will re-examine the scatterplot using the log-transformed outcome to see how this transformation affects the relationship.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> movies, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> Lbudget)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Movie age&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;ln(Movie Budget)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-41"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-41-1.png" alt="Scatterplot between age and budget. The loess smoother is also displayed." width="50%" />
<p class="caption">
Figure 3.3: Scatterplot between age and budget. The loess smoother is also displayed.
</p>
</div>
<p>Log-transforming the outcome has drastically affected the scale for the outcome. Has this helped us better meet the assumptions? Again, we should examine the residual plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit model</span>
lm.<span class="dv">2</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> movies)

<span class="co"># Obtain residuals and fitted values</span>
out_<span class="dv">2</span> =<span class="st"> </span><span class="kw">augment</span>(lm.<span class="dv">2</span>)

<span class="co"># Density plot of the residuals</span>
<span class="kw">sm.density</span>(out_<span class="dv">2</span><span class="op">$</span>.std.resid, <span class="dt">model =</span> <span class="st">&quot;normal&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Standardized residuals&quot;</span>)

<span class="co"># Residuals versus fitted values</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> out_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .std.resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Fitted values&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Standardized residuals&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-42"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-42-1.png" alt="Residual plots from regressing the natural logarithm of budget on age." width="40%" /><img src="epsy-8252-notes_files/figure-html/unnamed-chunk-42-2.png" alt="Residual plots from regressing the natural logarithm of budget on age." width="40%" />
<p class="caption">
Figure 3.4: Residual plots from regressing the natural logarithm of budget on age.
</p>
</div>
<p>These plots still suggest violations of the normality assumption (the marginal distribution of the residuals is now left-skewed). The assumption of homoskedasticity also seems still violated, although much less. Most importantly, however, is the assumption of linearity now seems satisfied.</p>
</div>
<div id="interpreting-the-regression-output" class="section level2">
<h2><span class="header-section-number">3.5</span> Interpreting the Regression Output</h2>
<p>Let’s examine the output from the model in which we regressed the log-transformed budget on age.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Model-level output</span>
<span class="kw">glance</span>(lm.<span class="dv">2</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["int"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"0.02131","2":"0.02076","3":"1.738","4":"39.27","5":"4.6e-10","6":"2","7":"-3560","8":"7125","9":"7142","10":"5448","11":"1804","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The model-level summary information suggests that differences in movies’ ages explains 2.1% of the variation in budget. (Remember, explaining variation in log-budget is the same as explaining variation in budget). Although this is a small amount of variation, it is statistically significant, <span class="math inline">\(F(1,1804)=39.27\)</span>, <span class="math inline">\(p&lt;0.001\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient-level output</span>
<span class="kw">tidy</span>(lm.<span class="dv">2</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.27813","3":"0.138935","4":"23.595","5":"1.688e-107"},{"1":"age","2":"-0.04408","3":"0.007035","4":"-6.267","5":"4.600e-10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>From the coefficient-level output the fitted equation is:</p>
<p><span class="math display">\[
\ln\left(\hat{\mathrm{Budget}_i}\right) = 3.28 - 0.04(\mathrm{Age}_i)
\]</span></p>
<p>With log-transformations, there are two possible interpretations we can offer. The first is to interpret the coefficients using the log-transformed values. These we interpret in the exact same way we do any other regression coefficients (except we use log-outcome instead of outcome):</p>
<ul>
<li>The intercept, <span class="math inline">\(\hat{\beta_0} = 3.28\)</span>, is the average predicted log-budget for movies made in 2019 (Age = 0).</li>
<li>The slope, <span class="math inline">\(\hat{\beta_1} = -0.04\)</span>, indicates that each one-year difference in age is associated with a log-budget that differ by <span class="math inline">\(-0.04\)</span>, on average.</li>
</ul>
<div id="back-transforming-a-more-useful-interpretation" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Back-Transforming: A More Useful Interpretation</h3>
<p>A second, probably more useful, interpretation is to back-transform log-budget to budget. To think about how to do this, we first consider a more general expression of the fitted linear model:</p>
<p><span class="math display">\[
\ln\left(\hat{Y}_i\right) = \hat\beta_0 + \hat\beta_1(X_{i})
\]</span></p>
<p>The left-hand side of the equation is in the log-transformed metric, which drives our interpreatations. If we want to instead, interpret using the raw metric of <span class="math inline">\(Y\)</span>, we need to back-transform from <span class="math inline">\(\ln(Y)\)</span> to <span class="math inline">\(Y\)</span>. To back-transform, we use the inverse function, which is to exponentiate using the base of the logarithm, in our case, base-<span class="math inline">\(e\)</span>.</p>
<p><span class="math display">\[
e^{\ln(Y_i)} = Y_i
\]</span></p>
<p>If we exponentiate the left-hand side of the equation, to maintain the equality, we also need to exponentiate the right-hand side of the equation.</p>
<p><span class="math display">\[
e^{\ln(Y_i)} = e^{\hat\beta_0 + \hat\beta_1(X_{i})}
\]</span></p>
<p>Then we use rules of exponents to simplify this.</p>
<p><span class="math display">\[
Y_i = e^{\hat\beta_0} \times e^{\hat\beta_1(X_{i})}
\]</span></p>
<p>For our example, when we exponentiate both sides of the fitted equation:</p>
<p><span class="math display">\[
\hat{\mathrm{Budget}_i} = e^{3.28} \times e^{-0.04(\mathrm{Age}_i)}
\]</span></p>
</div>
<div id="substituting-in-values-for-age-to-interpret-effects" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Substituting in Values for Age to Interpret Effects</h3>
<p>To interpret the effects (which are now interpreted using budget—not log-budget) we can substitute in the different values for age and solve. For example when Age = 0:</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Budget}_i} &amp;= e^{3.28} \times e^{-0.04(0)}\\
&amp;= 26.58 \times 1 \\
&amp;= 26.58
\end{split}
\]</span></p>
<p>The predicted budget for a movie made in 2019 is 26.58 million dollars. How about a movie that was made in 2018 (a one-year difference)?</p>
<p><span class="math display">\[
\begin{split}
\hat{\mathrm{Budget}_i} &amp;= e^{3.28} \times e^{-0.04(1)}\\
&amp;= 26.58 \times 0.96 \\
&amp;= 25.54
\end{split}
\]</span></p>
<p>The predicted budget for a movie made in 2019 is 25.54 million dollars. This is 0.96 TIMES the budget of a movie made in 2018.</p>
<p>Rather than using the language of <strong>TIMES difference</strong> you could also use the language of <strong>fold difference</strong>. In this case the slope coefficient would be interpreted as,</p>
<blockquote>
<p>Each one-year difference in age is associated with a 0.95-fold difference in budget, on average.</p>
</blockquote>
<p>Simply put, when we back-transform from interpretations of log-<span class="math inline">\(Y\)</span> to <span class="math inline">\(Y\)</span> the interpretations are multiplicatively related to the intercept rather than additive. We can obtain these multiplicative values (and the back-transformed intercept) by using the <code>exp()</code> function to exponentiate the coefficients from the fitted model, which we obtain using the <code>coef()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(lm.<span class="dv">2</span>))</code></pre></div>
<pre><code>(Intercept)         age 
    26.5261      0.9569 </code></pre>
</div>
<div id="approximate-interpretation-of-the-slope" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Approximate Interpretation of the Slope</h3>
<p>Remember that by using the natural logarithm we can interpret the effects as percent change. Rather than saying that a movie made in 2018 is predicted to have a budget that is 0.96 TIMES that of a movie made in 2019, we can directly interpret the slope as the percent change. Thus <span class="math inline">\(\hat{\beta_1}=-0.04\)</span> can be interpreted as:</p>
<blockquote>
<p>Each one-year difference in age is associated with a four percent decrease in budget, on average.</p>
</blockquote>
<p>If you want the specific mathematical change in budget, find <span class="math inline">\(1 - e^{\hat{\beta_1}}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.04</span>)</code></pre></div>
<pre><code>[1] 0.03921</code></pre>
<p>If you use the language of percent decrease/increase, be very careful. <em>Percent change</em> and <em>percentage change</em> are sometimes interpreted differently! It is generally more clear to use the <em>X-fold difference</em> language.</p>
</div>
</div>
<div id="plotting-the-fitted-model-1" class="section level2">
<h2><span class="header-section-number">3.6</span> Plotting the Fitted Model</h2>
<p>As always, we can plot the fitted model to aid in interpretation. To do this we will create a sequence of ages, predict the log-budget using the fitted model, and then back-transform the log-budgets to raw budget.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set up data</span>
plot_data =<span class="st"> </span><span class="kw">crossing</span>(
    <span class="dt">age =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">13</span>, <span class="dt">to =</span> <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">1</span>)
    ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="co"># Predict</span>
    <span class="dt">yhat =</span> <span class="kw">predict</span>(lm.<span class="dv">2</span>, <span class="dt">newdata =</span> .)
  )

<span class="co"># Examine data</span>
<span class="kw">head</span>(plot_data)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["yhat"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"13","2":"2.705"},{"1":"14","2":"2.661"},{"1":"15","2":"2.617"},{"1":"16","2":"2.573"},{"1":"17","2":"2.529"},{"1":"18","2":"2.485"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Back-transform the log-budgets</span>
plot_data =<span class="st"> </span>plot_data <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">budget =</span> <span class="kw">exp</span>(yhat)
  )

<span class="co"># Examine data</span>
<span class="kw">head</span>(plot_data)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["yhat"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["budget"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"13","2":"2.705","3":"14.95"},{"1":"14","2":"2.661","3":"14.31"},{"1":"15","2":"2.617","3":"13.69"},{"1":"16","2":"2.573","3":"13.10"},{"1":"17","2":"2.529","3":"12.54"},{"1":"18","2":"2.485","3":"12.00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> plot_data, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> budget)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Age&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Predicted budget (in millions of U.S. dollars)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-47"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-47-1.png" alt="Plot of the predicted movie budget as a function of its age. The non-linearity in the plot indicates that there is a diminishing negative effect of age on budget." width="50%" />
<p class="caption">
Figure 3.5: Plot of the predicted movie budget as a function of its age. The non-linearity in the plot indicates that there is a diminishing negative effect of age on budget.
</p>
</div>
<p>Based on this plot, we see the non-linear, negative effect of age on budget. In other words, older movies tend to have a smaller budget, on average, but this decrease is not constant. This pattern of non-linear decline is referred to as <em>exponential decay</em>.</p>
<p>Although this function has a different look than the function we saw in the previous unit (it is negative rather than positive), it is also a <em>monotonic</em> function (no change in direction).</p>
</div>
<div id="relationship-between-mpaa-rating-and-budget" class="section level2">
<h2><span class="header-section-number">3.7</span> Relationship between MPAA Rating and Budget</h2>
<p>We also may want to control for differences in MPAA rating. Before we fit the multiple regression model, however, we will first explore whether MPAA rating is a useful covariate by seeing whether there are differences in budget between PG, PG-13m and R rated movies. Since we log-transformed budget (the outcome) in the previous analysis we will need to use the log-transformed outcome in this exploration as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the observed data</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> movies, <span class="kw">aes</span>(<span class="dt">x =</span> mpaa, <span class="dt">y =</span> Lbudget)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> <span class="st">&#39;mean&#39;</span>, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;MPAA rating&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;ln(Movie Budget)&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-48"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-48-1.png" alt="Jittered scatterplot of log-budget versus MPAA rating." width="50%" />
<p class="caption">
Figure 3.6: Jittered scatterplot of log-budget versus MPAA rating.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compute summary statistics</span>
movies <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(mpaa) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(
    <span class="dt">M =</span> <span class="kw">mean</span>(Lbudget), 
    <span class="dt">SD =</span> <span class="kw">sd</span>(Lbudget)
    )</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mpaa"],"name":[1],"type":["chr"],"align":["left"]},{"label":["M"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SD"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"PG","2":"2.880","3":"1.532"},{"1":"PG-13","2":"3.142","3":"1.510"},{"1":"R","2":"2.013","3":"1.780"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The scatterplot and summary statistics indicate there are sample differences in the mean log-budgets for the three MPAA ratings. The variation in log-budgets seems roughly the same for the three ratings.</p>
<div id="regression-model" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Regression Model</h3>
<p>Let’s regress log-transformed budget on MPAA rating and examine the output from the model. To do so, we will need to first create three dummy variables for the different ratings.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create dummy variables</span>
movies =<span class="st"> </span>movies <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">pg   =</span> <span class="kw">if_else</span>(mpaa <span class="op">==</span><span class="st"> &quot;PG&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">pg13 =</span> <span class="kw">if_else</span>(mpaa <span class="op">==</span><span class="st"> &quot;PG-13&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),
    <span class="dt">r    =</span> <span class="kw">if_else</span>(mpaa <span class="op">==</span><span class="st"> &quot;R&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)
  )

<span class="co"># Fit the model (pg is reference group)</span>
lm.<span class="dv">3</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>pg13 <span class="op">+</span><span class="st"> </span>r, <span class="dt">data =</span> movies)

<span class="co"># Model-level output</span>
<span class="kw">glance</span>(lm.<span class="dv">3</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["int"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"0.08919","2":"0.08818","3":"1.677","4":"88.28","5":"2.663e-37","6":"3","7":"-3495","8":"6997","9":"7019","10":"5070","11":"1803","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The model-level summary information suggests that differences in MPAA rating explains 8.9% of the variation in budget. (Remember, explaining variation in log-budget is the same as explaining variation in budget). Although this is a small amount of variation, it is statistically significant, <span class="math inline">\(F(2,1803)=88.28\)</span>, <span class="math inline">\(p&lt;0.001\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient-level output</span>
<span class="kw">tidy</span>(lm.<span class="dv">3</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"2.8800","3":"0.1152","4":"25.006","5":"9.976e-119"},{"1":"pg13","2":"0.2622","3":"0.1363","4":"1.924","5":"5.447e-02"},{"1":"r","2":"-0.8671","3":"0.1261","4":"-6.875","5":"8.493e-12"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>From the coefficient-level output we see that the fitted equation is:</p>
<p><span class="math display">\[
\ln\left(\hat{\mathrm{Budget}_i}\right) = 2.88 + 0.26(\mathrm{PG\mbox{-}13}_i) - 0.87(\mathrm{R}_i)
\]</span></p>
<p>With log-transformations, there are two possible interpretations we can offer. The first is to interpret the coefficients using the log-transformed values. These we interpret in the exact same way we do any other regression coefficients (except we use log-outcome instead of outcome):</p>
<ul>
<li>The intercept, <span class="math inline">\(\hat{\beta_0} = 2.88\)</span>, is the average predicted log-budget for PG rated movies.</li>
<li>The slope associated with PG-13, <span class="math inline">\(\hat{\beta_1} = 0.26\)</span>, indicates that PG-13 rated movies have a log-budget that is 0.26 higher than PG rated movies, on average.</li>
<li>The slope associated with R, <span class="math inline">\(\hat{\beta_2} = -0.87\)</span>, indicates that R rated movies have a log-budget that is 0.87 lower than PG rated movies, on average.</li>
</ul>
<p>We can also interpet these by back-transforming to raw budget. To do that we exponentiate the coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(lm.<span class="dv">3</span>))</code></pre></div>
<pre><code>(Intercept)        pg13           r 
    17.8134      1.2998      0.4201 </code></pre>
<ul>
<li>PG rated movies have a budget of 17.81 million dollars, on average.</li>
<li>PG-13 rated movies have a budget that is 1.30 TIMES the estimated budget for PG rated movies, on average.</li>
<li>R rated movies have a budget that is 0.42 TIMES the estimated budget for PG rated movies, on average.</li>
</ul>
</div>
<div id="mathematical-explanation-1" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Mathematical Explanation</h3>
<p>Remember, if we want to interpret using the raw metric of <span class="math inline">\(Y\)</span>, we need to back-transform from <span class="math inline">\(\ln(Y)\)</span> to <span class="math inline">\(Y\)</span>. To back-transform, we use the inverse function, which is to exponentiate using the base of the logarithm, in our case, base-<span class="math inline">\(e\)</span>. For our example, when we exponentiate both sides of the fitted equation:</p>
<p><span class="math display">\[
\begin{split}
e^{\ln\left(\hat{\mathrm{Budget}_i}\right)} &amp;= e^{2.88 + 0.26(\mathrm{PG\mbox{-}13}_i) - 0.87(\mathrm{R}_i)} \\
\hat{\mathrm{Budget}_i} &amp;= e^{2.88} \times e^{0.26(\mathrm{PG\mbox{-}13}_i)} \times e^{-0.87(\mathrm{R}_i)}
\end{split}
\]</span></p>
<p>To interpret the effects (which are now interpreted using budget—not log-budget) we can substitute in the different dummy variable patterns and solve.</p>
<p><span class="math display">\[
\begin{split}
\textbf{PG Movie:}~~ \hat{\mathrm{Budget}_i} &amp;= e^{2.88} \times e^{0.26(0)} \times e^{-0.87(0)}\\
&amp;= 17.81 \times 1 \times 1 \\
&amp;= 17.81
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\textbf{PG-13 Movie:}~~ \hat{\mathrm{Budget}_i} &amp;= e^{2.88} \times e^{0.26(1)} \times e^{-0.87(0)}\\
&amp;= 17.81 \times 1.30 \times 1 \\
&amp;= 23.15
\end{split}
\]</span></p>
<p><span class="math display">\[
\begin{split}
\textbf{R Movie:}~~ \hat{\mathrm{Budget}_i} &amp;= e^{2.88} \times e^{0.26(0)} \times e^{-0.87(1)}\\
&amp;= 17.81 \times 1 \times 0.42 \\
&amp;= 7.48
\end{split}
\]</span></p>
</div>
<div id="approximate-interpretations" class="section level3">
<h3><span class="header-section-number">3.7.3</span> Approximate Interpretations</h3>
<p>Unfortunately, the approximate interpretations of the slopes by directly interpreting the coefficients using the language of percent change are not completely trustworthy. If we did interpret them, the interpretations for the two slopes would be:</p>
<ul>
<li>PG-13 rated movies have budget that is 26.2 percent higher than PG rated movies, on average.</li>
<li>R rated movies have budget that is 87 percent lower than PG rated movies, on average.</li>
</ul>
<p>This interpretation is roughly true for the PG-13 effect, but not for the R effect. This approximate interpretation starts to become untrustworthy when the slope value is higher than about 0.20 or so.</p>
</div>
</div>
<div id="multiple-regression-main-effects-model" class="section level2">
<h2><span class="header-section-number">3.8</span> Multiple Regression: Main Effects Model</h2>
<p>Now we can fit a model that includes our focal predictor of age and our covariate of MPAA rating.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit model (PG is reference group)</span>
lm.<span class="dv">4</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>pg13 <span class="op">+</span><span class="st"> </span>r, <span class="dt">data =</span> movies)

<span class="co"># Model-level output</span>
<span class="kw">glance</span>(lm.<span class="dv">4</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["int"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"0.1095","2":"0.108","3":"1.659","4":"73.84","5":"4.821e-45","6":"4","7":"-3474","8":"6959","9":"6986","10":"4957","11":"1802","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The model-level summary information suggests that differences in age and MPAA rating of a movie explains 11.0% of the variation in budget. (Remember, explaining variation in log-budget is the same as explaining variation in budget); <span class="math inline">\(F(3,1802)=73.84\)</span>, <span class="math inline">\(p&lt;0.001\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient-level output</span>
<span class="kw">tidy</span>(lm.<span class="dv">4</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.7308","3":"0.174959","4":"21.324","5":"3.763e-90"},{"1":"age","2":"-0.0431","3":"0.006727","4":"-6.407","5":"1.888e-10"},{"1":"pg13","2":"0.2084","3":"0.135045","4":"1.543","5":"1.229e-01"},{"1":"r","2":"-0.9036","3":"0.124876","4":"-7.236","5":"6.791e-13"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The coefficient-level output suggest that there is still a statistically significant effect of age on budget, after controlling for differences in MPAA rating; <span class="math inline">\(t(1802)=-6.41\)</span>, <span class="math inline">\(p&lt;.001\)</span>.</p>
<p>To determine if there is an effect of MPAA rating, after accounting for differences in age, at least one of the effects of MPAA rating need to be statistically significant. Here we see that the coefficient associated with rated R movies is statistically significant.</p>
<p>Remember that when we have more than two categories (more than one dummy variable) there can be many ways for the effect to play out, and not all of these are represented in the model we fitted. One way we can simultaneously examine ALL the ways this effect can play out is to use a nested <span class="math inline">\(F\)</span>-test.</p>
<div id="nested-f-test" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Nested F-Test</h3>
<p>If we want to examine if there is a controlled effect of MPAA rating (controlling for age), we want to see whether by including MPAA rating in a model THAT ALREDY INCLUDES age we explain additional variation in the outcome. To do this we can compare a model that only includes the effect of age to a model that includes both the effects of age and MPAA rating. If the latter model explains a statistically significant amount of additional variation we can say that there is an effect of MPAA rating after controlling for differences in age.</p>
<p>In statistical hypothesis testing we are examining the following null hypothesis:</p>
<p><span class="math display">\[
H_0: \rho^2_{\mathrm{Age},\mathrm{MPAA~rating}} - \rho^2_{\mathrm{Age}} = 0
\]</span></p>
<p>If we fail to reject this hypothesis, then the two models explain the SAME amount of variation and we should adopt the simpler model; MPAA rating does not explain additional variation in budget. If we reject this hypothesis, MPAA rating does explain additional variation in budget, above and beyond age; and we should adopt the model that includes both effects.</p>
<p>To test this hypothesis we fit both models and then give both models to the <code>anova()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit models</span>
lm.<span class="dv">2</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age,            <span class="dt">data =</span> movies)
lm.<span class="dv">4</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>pg13 <span class="op">+</span><span class="st"> </span>r, <span class="dt">data =</span> movies)

<span class="co"># Nested F-test</span>
<span class="kw">anova</span>(lm.<span class="dv">2</span>, lm.<span class="dv">4</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1804","2":"5448","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"1802","2":"4957","3":"2","4":"490.8","5":"89.21","6":"1.144e-37","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The test suggests that there is a statistically significant effect of MPAA rating even after accounting for differences in age; <span class="math inline">\(F(2, 1802)=89.21\)</span>, <span class="math inline">\(p&lt;.001\)</span>.</p>
</div>
<div id="coefficient-level-interpretation" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Coefficient-Level Interpretation</h3>
<p>To interpret the coefficients, we will again exponentiate the fitted coefficients so we can interpret them using the raw-metric of budget.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(<span class="kw">coef</span>(lm.<span class="dv">4</span>))</code></pre></div>
<pre><code>(Intercept)         age        pg13           r 
    41.7120      0.9578      1.2318      0.4051 </code></pre>
<ul>
<li>The model estimated budget for a PG movie (reference group) that was made in 2019 (age = 0) is 41.71 million dollars.</li>
<li>Each one-year difference in age is associated with a 0.96-fold difference (4.3% decrease) in budget, on average, controlling for differences in MPAA rating.</li>
<li>PG-13 rated movies have a budget that is 1.23 times that for PG movies, on average, controlling for differences in age.</li>
<li>R rated movies have a budget that is 0.41 times that for PG movies, on average, controlling for differences in age.</li>
</ul>
</div>
<div id="plot-of-the-fitted-model" class="section level3">
<h3><span class="header-section-number">3.8.3</span> Plot of the Fitted Model</h3>
<p>To plot the fitted model that includes a categorical predictor with more than two levels, it is best to re-fit the <code>lm()</code> using the categorical variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Re-fit the model</span>
lm.<span class="dv">5</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>mpaa, <span class="dt">data =</span> movies)

<span class="co"># Model-level output</span>
<span class="kw">glance</span>(lm.<span class="dv">5</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["int"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]}],"data":[{"1":"0.1095","2":"0.108","3":"1.659","4":"73.84","5":"4.821e-45","6":"4","7":"-3474","8":"6959","9":"6986","10":"4957","11":"1802","_rn_":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Coefficient-level output</span>
<span class="kw">tidy</span>(lm.<span class="dv">5</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.7308","3":"0.174959","4":"21.324","5":"3.763e-90"},{"1":"age","2":"-0.0431","3":"0.006727","4":"-6.407","5":"1.888e-10"},{"1":"mpaaPG-13","2":"0.2084","3":"0.135045","4":"1.543","5":"1.229e-01"},{"1":"mpaaR","2":"-0.9036","3":"0.124876","4":"-7.236","5":"6.791e-13"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Note this is the exact same model we fitted using the dummy variables, but R will choose the reference group for us (alphabetically). We can now set up our plotting data, predict, back-transform the outcome, and plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set up data</span>
plot_data =<span class="st"> </span><span class="kw">crossing</span>(
    <span class="dt">age =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">13</span>, <span class="dt">to =</span> <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">1</span>),
    <span class="dt">mpaa =</span> <span class="kw">c</span>(<span class="st">&quot;PG&quot;</span>, <span class="st">&quot;PG-13&quot;</span>, <span class="st">&quot;R&quot;</span>)
    ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">yhat =</span> <span class="kw">predict</span>(lm.<span class="dv">5</span>, <span class="dt">newdata =</span> .),
    <span class="dt">budget =</span> <span class="kw">exp</span>(yhat)
  )

<span class="co"># Examine data</span>
<span class="kw">head</span>(plot_data)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mpaa"],"name":[2],"type":["chr"],"align":["left"]},{"label":["yhat"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["budget"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"13","2":"PG","3":"3.170","4":"23.819"},{"1":"13","2":"PG-13","3":"3.379","4":"29.339"},{"1":"13","2":"R","3":"2.267","4":"9.649"},{"1":"14","2":"PG","3":"3.127","4":"22.814"},{"1":"14","2":"PG-13","3":"3.336","4":"28.101"},{"1":"14","2":"R","3":"2.224","4":"9.242"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> plot_data, <span class="kw">aes</span>(<span class="dt">x =</span> age, <span class="dt">y =</span> budget, <span class="dt">color =</span> mpaa, <span class="dt">linetype =</span> mpaa)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Age&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Predicted budget (in millions of U.S. dollars)&quot;</span>) <span class="op">+</span>
<span class="st">  </span>ggsci<span class="op">::</span><span class="kw">scale_color_d3</span>(<span class="dt">name =</span> <span class="st">&quot;MPAA rating&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">name =</span> <span class="st">&quot;MPAA rating&quot;</span>, <span class="dt">values =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-57"></span>
<img src="epsy-8252-notes_files/figure-html/unnamed-chunk-57-1.png" alt="Plot of the predicted movie budget as a function of its age and MPAA rating. The non-linearity in the plot indicates that there is a diminishing negative effect of age on budget." width="50%" />
<p class="caption">
Figure 3.7: Plot of the predicted movie budget as a function of its age and MPAA rating. The non-linearity in the plot indicates that there is a diminishing negative effect of age on budget.
</p>
</div>
<p>The plot displays the negative, nonlinear effect of age on budget for all three types of movies (main effect of age). It also shows that PG-13 rated movies have a higher predicted budget than PG and R rated movies, and that PG rated movies have a higher predicted budget than R rated movies at EVERY age. This is the main effect of MPAA rating.</p>
<p>Notice that in the plot, the three lines are not parallel. This is a mathematical artifact of back-transforming log-budget to raw budget. It does not indicate that an interaction model was fitted. How non-parallel the lines are depends on the size of the coefficients associated with the MPAA effects (in this example). This is why, especially with transformed data, it is essential to plot the model to make sure you are understanding the interpretations from your coefficients.</p>
</div>
</div>
<div id="multiple-regression-interaction-model" class="section level2">
<h2><span class="header-section-number">3.9</span> Multiple Regression: Interaction Model</h2>
<p>To study whether there is an interaction effect between MPAA rating and age, we will fit the interaction model and compare it to the main-effects model using the nested <span class="math inline">\(F\)</span>-test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit the models</span>
lm.<span class="dv">5</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>mpaa,            <span class="dt">data =</span> movies)
lm.<span class="dv">6</span> =<span class="st"> </span><span class="kw">lm</span>(Lbudget <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>mpaa <span class="op">+</span><span class="st"> </span>age<span class="op">:</span>mpaa, <span class="dt">data =</span> movies)

<span class="co"># Nested F-test</span>
<span class="kw">anova</span>(lm.<span class="dv">5</span>, lm.<span class="dv">6</span>)</code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1802","2":"4957","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"1800","2":"4949","3":"2","4":"7.762","5":"1.411","6":"0.244","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The test suggests that we should adopt the main-effects model. The interaction-effect was not statistically significant; <span class="math inline">\(F(2,1800)=1.41\)</span>, <span class="math inline">\(p=.244\)</span>.</p>
<p>If the model that included the interaction effect was adopted, it would suggest that: (1) the effect of age on budget depends on MPAA rating, or (2) the effect of MPAA rating on budget depnds on age of the movie. To further interpret these effects, you should plot the results of the fitted interaction model.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nonlinearity-log-transforming-the-predictor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="log-transformations-some-final-thoughts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {},
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"collapse": "section",
"toolbar": null,
"position": "fixed",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
